[0m17:56:56.252289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b281d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba4c80>]}


============================== 17:56:56.256847 | 9573b139-125a-46e3-9c66-017636724663 ==============================
[0m17:56:56.256847 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:56:56.257372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/telvin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:56.450269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9573b139-125a-46e3-9c66-017636724663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113be9c0>]}
[0m17:56:56.497431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9573b139-125a-46e3-9c66-017636724663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba4410>]}
[0m17:56:56.501140 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:56:56.570493 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:56:56.572069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.37237993, "process_in_blocks": "0", "process_kernel_time": 0.194693, "process_mem_max_rss": "111017984", "process_out_blocks": "0", "process_user_time": 1.383664}
[0m17:56:56.572484 [debug] [MainThread]: Command `dbt run` failed at 17:56:56.572397 after 0.37 seconds
[0m17:56:56.572928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111299af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114730b0>]}
[0m17:56:56.573292 [debug] [MainThread]: Flushing usage events
[0m17:56:57.822451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:02.747036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110279970>]}


============================== 17:57:02.751702 | 815231aa-8977-4097-91fc-42a3c4979e54 ==============================
[0m17:57:02.751702 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:57:02.752228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/telvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:57:02.861162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '815231aa-8977-4097-91fc-42a3c4979e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a50b60>]}
[0m17:57:02.876024 [debug] [MainThread]: Set downloads directory='/var/folders/0h/c1fdg6917qg28vb3365bqjxh0000gn/T/dbt-downloads-de59oaxy'
[0m17:57:02.876424 [info ] [MainThread]: Installing ../retail_ops
[0m17:57:02.877202 [debug] [MainThread]: Creating symlink to local dependency.
[0m17:57:02.877603 [info ] [MainThread]: Installed from <local @ ../retail_ops>
[0m17:57:02.877941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '815231aa-8977-4097-91fc-42a3c4979e54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cf920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c2150>]}
[0m17:57:02.879458 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18603404, "process_in_blocks": "0", "process_kernel_time": 0.147164, "process_mem_max_rss": "102449152", "process_out_blocks": "0", "process_user_time": 1.227124}
[0m17:57:02.879839 [debug] [MainThread]: Command `dbt deps` succeeded at 17:57:02.879758 after 0.19 seconds
[0m17:57:02.880137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110509430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e9430>]}
[0m17:57:02.880423 [debug] [MainThread]: Flushing usage events
[0m17:57:03.991717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:19.430617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b706b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b71940>]}


============================== 17:57:19.435298 | 558970d5-951c-4f9f-82f3-af3cf9dda6af ==============================
[0m17:57:19.435298 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:57:19.435839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/telvin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:19.626831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4e720>]}
[0m17:57:19.674005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3a750>]}
[0m17:57:19.677735 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:57:19.757001 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:57:19.757806 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:57:19.758146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d4380>]}
[0m17:57:20.838967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4e540>]}
[0m17:57:20.909579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:57:20.911322 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:57:20.924646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133de7e0>]}
[0m17:57:20.925067 [info ] [MainThread]: Found 11 models, 6 data tests, 9 sources, 426 macros
[0m17:57:20.925375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b3f20>]}
[0m17:57:20.927247 [info ] [MainThread]: 
[0m17:57:20.927560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:20.927804 [info ] [MainThread]: 
[0m17:57:20.928173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:20.932776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse_customer'
[0m17:57:20.980439 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:57:20.980814 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m17:57:20.981064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:21.053840 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m17:57:21.054246 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:57:21.054532 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m17:57:21.082681 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:57:21.084658 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m17:57:21.086118 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m17:57:21.086389 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m17:57:21.087347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558970d5-951c-4f9f-82f3-af3cf9dda6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356ce00>]}
[0m17:57:21.089623 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m17:57:21.090006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m17:57:21.090337 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m17:57:21.096904 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m17:57:21.097799 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m17:57:21.098351 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m17:57:21.098667 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m17:57:21.099016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m17:57:21.099333 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m17:57:21.101333 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m17:57:21.101837 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m17:57:21.102328 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m17:57:21.102619 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m17:57:21.102930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m17:57:21.103231 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m17:57:21.105249 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m17:57:21.105743 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m17:57:21.106208 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m17:57:21.106493 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m17:57:21.106803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m17:57:21.107105 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m17:57:21.110287 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m17:57:21.111024 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m17:57:21.111526 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m17:57:21.111826 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m17:57:21.112131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m17:57:21.112421 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m17:57:21.114299 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m17:57:21.114756 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m17:57:21.115229 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m17:57:21.115530 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m17:57:21.115823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m17:57:21.116113 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m17:57:21.118122 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m17:57:21.118600 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m17:57:21.119076 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m17:57:21.119360 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m17:57:21.119651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m17:57:21.119911 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m17:57:21.121870 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m17:57:21.122328 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m17:57:21.122782 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m17:57:21.123075 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:57:21.123385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d)
[0m17:57:21.123687 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:57:21.133438 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d"
[0m17:57:21.134068 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:57:21.134575 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:57:21.134876 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:57:21.135175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d, now test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19)
[0m17:57:21.135448 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:57:21.140560 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19"
[0m17:57:21.141116 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:57:21.141620 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:57:21.141925 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:57:21.142229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19, now test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc)
[0m17:57:21.142502 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:57:21.145652 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc"
[0m17:57:21.146141 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:57:21.146627 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:57:21.146923 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:57:21.147217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc, now test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718)
[0m17:57:21.147493 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:57:21.150501 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718"
[0m17:57:21.150991 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:57:21.151473 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:57:21.151769 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m17:57:21.152069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718, now model.customer_360.customer_profile_360)
[0m17:57:21.152349 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m17:57:21.154977 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m17:57:21.155547 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m17:57:21.156029 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m17:57:21.156336 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:57:21.156638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:57:21.156924 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:57:21.160000 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:57:21.160495 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:57:21.160969 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:57:21.161260 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:57:21.161587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.customer_360.unique_stg_customers_customer_id.c7614daada)
[0m17:57:21.161923 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:57:21.165114 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customers_customer_id.c7614daada"
[0m17:57:21.165655 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:57:21.166170 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:57:21.166483 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m17:57:21.166793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customers_customer_id.c7614daada, now model.retail_ops.inventory_status)
[0m17:57:21.167071 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m17:57:21.169531 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m17:57:21.170105 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m17:57:21.170592 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m17:57:21.170884 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m17:57:21.171185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.customer_360.customer_orders)
[0m17:57:21.171455 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m17:57:21.175236 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m17:57:21.175775 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m17:57:21.176295 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m17:57:21.176593 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m17:57:21.176921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.retail_ops.product_sales)
[0m17:57:21.177193 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m17:57:21.179577 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m17:57:21.180140 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m17:57:21.180638 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m17:57:21.181396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:21.181633 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m17:57:21.183557 [debug] [MainThread]: Command end result
[0m17:57:21.202758 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:57:21.204048 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:57:21.209762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m17:57:21.211576 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8340237, "process_in_blocks": "0", "process_kernel_time": 0.276609, "process_mem_max_rss": "141262848", "process_out_blocks": "0", "process_user_time": 2.681454}
[0m17:57:21.211944 [debug] [MainThread]: Command `dbt compile` succeeded at 17:57:21.211874 after 1.83 seconds
[0m17:57:21.212254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113338530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bb3d10>]}
[0m17:57:21.212554 [debug] [MainThread]: Flushing usage events
[0m17:57:22.296460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:26.050968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104876f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589fef0>]}


============================== 17:57:26.055585 | c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a ==============================
[0m17:57:26.055585 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:57:26.056120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'debug': 'False', 'profiles_dir': '/Users/telvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:26.244208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928680>]}
[0m17:57:26.290997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531a360>]}
[0m17:57:26.294636 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:57:26.373564 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:57:26.474051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:26.474448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:26.511977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf9d60>]}
[0m17:57:26.583236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:57:26.584756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:57:26.597002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfa060>]}
[0m17:57:26.597413 [info ] [MainThread]: Found 11 models, 6 data tests, 9 sources, 426 macros
[0m17:57:26.597716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeb8f0>]}
[0m17:57:26.599514 [info ] [MainThread]: 
[0m17:57:26.599817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:26.600057 [info ] [MainThread]: 
[0m17:57:26.600454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:26.604819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse'
[0m17:57:26.646014 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse"
[0m17:57:26.646421 [debug] [ThreadPool]: On list_retail_warehouse: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"retail_warehouse"'
    
  
  
[0m17:57:26.646709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:26.658404 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:57:26.659664 [debug] [ThreadPool]: On list_retail_warehouse: Close
[0m17:57:26.660266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_warehouse, now create_retail_warehouse_customer)
[0m17:57:26.661535 [debug] [ThreadPool]: Creating schema "database: "retail_warehouse"
schema: "customer"
"
[0m17:57:26.667534 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:57:26.667838 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
        select type from duckdb_databases()
        where lower(database_name)='retail_warehouse'
        and type='sqlite'
    
  
[0m17:57:26.668091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:26.668733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:26.670023 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:57:26.670277 [debug] [ThreadPool]: On create_retail_warehouse_customer: BEGIN
[0m17:57:26.670620 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:26.670839 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:57:26.671061 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
    
        create schema if not exists "retail_warehouse"."customer"
    
[0m17:57:26.671434 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:26.672102 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m17:57:26.672342 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:57:26.672585 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m17:57:26.672933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:26.673247 [debug] [ThreadPool]: On create_retail_warehouse_customer: Close
[0m17:57:26.674560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_warehouse_customer, now list_retail_warehouse_customer)
[0m17:57:26.679240 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:57:26.679516 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m17:57:26.679743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:26.680118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:26.680386 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:57:26.680645 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m17:57:26.696590 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m17:57:26.697713 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m17:57:26.698809 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m17:57:26.699063 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m17:57:26.699887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edf9b0>]}
[0m17:57:26.700260 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:26.700495 [debug] [MainThread]: On master: BEGIN
[0m17:57:26.700707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:26.701047 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:26.701269 [debug] [MainThread]: On master: COMMIT
[0m17:57:26.701482 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:26.701691 [debug] [MainThread]: On master: COMMIT
[0m17:57:26.701992 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:26.702208 [debug] [MainThread]: On master: Close
[0m17:57:26.703840 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m17:57:26.704241 [info ] [Thread-1 (]: 1 of 11 START sql view model customer.stg_customer_feedback .................... [RUN]
[0m17:57:26.704583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m17:57:26.704859 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m17:57:26.710731 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m17:57:26.711364 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m17:57:26.741062 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_feedback"
[0m17:57:26.742155 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:57:26.742485 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: BEGIN
[0m17:57:26.742771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.743283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:26.743559 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:57:26.743851 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */

  
  create view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" as (
    

SELECT
    feedback_id,
    customer_id,
    sale_id,
    rating,
    feedback_text,
    feedback_date
FROM customer.raw_customer_feedback
  );

[0m17:57:26.744440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.749689 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:57:26.750034 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" rename to "stg_customer_feedback"
[0m17:57:26.751040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:26.759854 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m17:57:26.760182 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:57:26.760465 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m17:57:26.762314 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:26.766596 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:57:26.766944 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_feedback__dbt_backup" cascade
[0m17:57:26.767651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.769624 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: Close
[0m17:57:26.771137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c722a0>]}
[0m17:57:26.771651 [info ] [Thread-1 (]: 1 of 11 OK created sql view model customer.stg_customer_feedback ............... [[32mOK[0m in 0.07s]
[0m17:57:26.772115 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m17:57:26.772428 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m17:57:26.772837 [info ] [Thread-1 (]: 2 of 11 START sql view model customer.stg_customer_preferences ................. [RUN]
[0m17:57:26.773169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m17:57:26.773452 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m17:57:26.775575 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m17:57:26.776139 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m17:57:26.779021 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_preferences"
[0m17:57:26.779662 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:57:26.779968 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: BEGIN
[0m17:57:26.780247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.780732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.781001 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:57:26.781280 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */

  
  create view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" as (
    

SELECT
    preference_id,
    customer_id,
    preferred_category,
    communication_channel,
    last_updated
FROM customer.raw_customer_preferences
  );

[0m17:57:26.781845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.784249 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:57:26.784558 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" rename to "stg_customer_preferences"
[0m17:57:26.785037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.786208 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m17:57:26.786522 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:57:26.786791 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m17:57:26.787388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.789369 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:57:26.789690 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_preferences__dbt_backup" cascade
[0m17:57:26.790175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.791504 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: Close
[0m17:57:26.791990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acf830>]}
[0m17:57:26.792502 [info ] [Thread-1 (]: 2 of 11 OK created sql view model customer.stg_customer_preferences ............ [[32mOK[0m in 0.02s]
[0m17:57:26.792945 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m17:57:26.793252 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m17:57:26.793677 [info ] [Thread-1 (]: 3 of 11 START sql view model customer.stg_customers ............................ [RUN]
[0m17:57:26.794080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m17:57:26.794387 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m17:57:26.796649 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m17:57:26.797239 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m17:57:26.800109 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customers"
[0m17:57:26.800840 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:57:26.801129 [debug] [Thread-1 (]: On model.customer_360.stg_customers: BEGIN
[0m17:57:26.801395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.801889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.802165 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:57:26.802443 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */

  
  create view "retail_warehouse"."customer"."stg_customers__dbt_tmp" as (
    

SELECT
    customer_id,
    first_name,
    last_name,
    email,
    signup_date,
    customer_segment
FROM customer.raw_customers
  );

[0m17:57:26.802988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.805441 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:57:26.805737 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:57:26.806177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.807312 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m17:57:26.807599 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:57:26.807865 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m17:57:26.808392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.810310 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:57:26.810614 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
drop view if exists "retail_warehouse"."customer"."stg_customers__dbt_backup" cascade
[0m17:57:26.811097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.812274 [debug] [Thread-1 (]: On model.customer_360.stg_customers: Close
[0m17:57:26.812757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d94bc0>]}
[0m17:57:26.813263 [info ] [Thread-1 (]: 3 of 11 OK created sql view model customer.stg_customers ....................... [[32mOK[0m in 0.02s]
[0m17:57:26.813756 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m17:57:26.814071 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m17:57:26.814504 [info ] [Thread-1 (]: 4 of 11 START sql view model customer.stg_inventory ............................ [RUN]
[0m17:57:26.814962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m17:57:26.815268 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m17:57:26.819184 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m17:57:26.819898 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m17:57:26.822625 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_inventory"
[0m17:57:26.823436 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:57:26.823718 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: BEGIN
[0m17:57:26.823984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.824479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.824741 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:57:26.825020 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */

  
  create view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" as (
    

SELECT
    inventory_id,
    product_id,
    warehouse_location,
    quantity_on_hand,
    reorder_point,
    last_restock_date
FROM retail.raw_inventory
  );

[0m17:57:26.825600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.828114 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:57:26.828448 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m17:57:26.829022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.830172 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m17:57:26.830477 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:57:26.831273 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m17:57:26.831907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.833976 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:57:26.834279 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
drop view if exists "retail_warehouse"."customer"."stg_inventory__dbt_backup" cascade
[0m17:57:26.834748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.835766 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: Close
[0m17:57:26.836183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6b890>]}
[0m17:57:26.836656 [info ] [Thread-1 (]: 4 of 11 OK created sql view model customer.stg_inventory ....................... [[32mOK[0m in 0.02s]
[0m17:57:26.837079 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m17:57:26.837373 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m17:57:26.837752 [info ] [Thread-1 (]: 5 of 11 START sql view model customer.stg_products ............................. [RUN]
[0m17:57:26.838090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m17:57:26.838379 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m17:57:26.840623 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m17:57:26.841466 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m17:57:26.844341 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_products"
[0m17:57:26.844940 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:57:26.845235 [debug] [Thread-1 (]: On model.retail_ops.stg_products: BEGIN
[0m17:57:26.845495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.845978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.846243 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:57:26.846508 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */

  
  create view "retail_warehouse"."customer"."stg_products__dbt_tmp" as (
    

SELECT * FROM retail.raw_products
  );

[0m17:57:26.847047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.849508 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:57:26.849802 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:57:26.850249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.851523 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m17:57:26.851810 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:57:26.852072 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m17:57:26.852688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.854634 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:57:26.854987 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
drop view if exists "retail_warehouse"."customer"."stg_products__dbt_backup" cascade
[0m17:57:26.855510 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.856605 [debug] [Thread-1 (]: On model.retail_ops.stg_products: Close
[0m17:57:26.857030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4c530>]}
[0m17:57:26.857746 [info ] [Thread-1 (]: 5 of 11 OK created sql view model customer.stg_products ........................ [[32mOK[0m in 0.02s]
[0m17:57:26.858405 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m17:57:26.858721 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m17:57:26.859179 [info ] [Thread-1 (]: 6 of 11 START sql view model customer.stg_promotions ........................... [RUN]
[0m17:57:26.859654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m17:57:26.859967 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m17:57:26.862308 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m17:57:26.862902 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m17:57:26.865669 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_promotions"
[0m17:57:26.866393 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:57:26.866685 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: BEGIN
[0m17:57:26.866948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.867465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:26.867732 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:57:26.868010 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */

  
  create view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" as (
    

SELECT
    promotion_id,
    product_id,
    promotion_name,
    discount_percentage,
    start_date,
    end_date
FROM retail.raw_promotions
  );

[0m17:57:26.868580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.871141 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:57:26.871522 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m17:57:26.872500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.873788 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m17:57:26.874098 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:57:26.874364 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m17:57:26.874924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.878016 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:57:26.878326 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
drop view if exists "retail_warehouse"."customer"."stg_promotions__dbt_backup" cascade
[0m17:57:26.878773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.879852 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: Close
[0m17:57:26.880405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db1ac0>]}
[0m17:57:26.880922 [info ] [Thread-1 (]: 6 of 11 OK created sql view model customer.stg_promotions ...................... [[32mOK[0m in 0.02s]
[0m17:57:26.881370 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m17:57:26.881669 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m17:57:26.882045 [info ] [Thread-1 (]: 7 of 11 START sql view model customer.stg_sales ................................ [RUN]
[0m17:57:26.882371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m17:57:26.882645 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m17:57:26.884770 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m17:57:26.885350 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m17:57:26.888329 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_sales"
[0m17:57:26.888972 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:57:26.889252 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: BEGIN
[0m17:57:26.889516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.890005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.890264 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:57:26.890540 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */

  
  create view "retail_warehouse"."customer"."stg_sales__dbt_tmp" as (
    

SELECT
    sale_id,
    product_id,
    customer_id,
    quantity,
    sale_date,
    total_amount
FROM retail.raw_sales
  );

[0m17:57:26.891086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.893603 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:57:26.893931 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:57:26.894448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.895667 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m17:57:26.896005 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:57:26.896273 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m17:57:26.896867 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.899080 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:57:26.899411 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
drop view if exists "retail_warehouse"."customer"."stg_sales__dbt_backup" cascade
[0m17:57:26.899985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.901133 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: Close
[0m17:57:26.901567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5c40>]}
[0m17:57:26.902053 [info ] [Thread-1 (]: 7 of 11 OK created sql view model customer.stg_sales ........................... [[32mOK[0m in 0.02s]
[0m17:57:26.902481 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m17:57:26.902782 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m17:57:26.903170 [info ] [Thread-1 (]: 8 of 11 START sql table model customer.customer_profile_360 .................... [RUN]
[0m17:57:26.903547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now model.customer_360.customer_profile_360)
[0m17:57:26.903869 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m17:57:26.906841 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m17:57:26.907484 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m17:57:26.925409 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_profile_360"
[0m17:57:26.926349 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:57:26.926638 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: BEGIN
[0m17:57:26.926895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.927404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.927679 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:57:26.928012 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_profile_360__dbt_tmp"
  
    as (
      

WITH customer_base AS (
    SELECT
        c.*,
        cp.preferred_category,
        cp.communication_channel
    FROM "retail_warehouse"."customer"."stg_customers" c
    LEFT JOIN "retail_warehouse"."customer"."stg_customer_preferences" cp ON c.customer_id = cp.customer_id
),

customer_feedback_agg AS (
    SELECT
        customer_id,
        AVG(rating) as avg_rating,
        COUNT(*) as total_feedback_count
    FROM "retail_warehouse"."customer"."stg_customer_feedback"
    GROUP BY customer_id
),

final_profile AS (
    SELECT
        cb.*,
        COALESCE(cf.avg_rating, 0) as average_rating,
        COALESCE(cf.total_feedback_count, 0) as feedback_count
    FROM customer_base cb
    LEFT JOIN customer_feedback_agg cf ON cb.customer_id = cf.customer_id
)

SELECT * FROM final_profile
    );
  
  
[0m17:57:26.937790 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:57:26.940512 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:57:26.940834 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360__dbt_tmp" rename to "customer_profile_360"
[0m17:57:26.941395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.945788 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m17:57:26.946115 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:57:26.946397 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m17:57:26.947534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:26.949664 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:57:26.949977 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
drop table if exists "retail_warehouse"."customer"."customer_profile_360__dbt_backup" cascade
[0m17:57:26.950414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.951548 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: Close
[0m17:57:26.951989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5e50>]}
[0m17:57:26.952490 [info ] [Thread-1 (]: 8 of 11 OK created sql table model customer.customer_profile_360 ............... [[32mOK[0m in 0.05s]
[0m17:57:26.952926 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m17:57:26.953232 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m17:57:26.953570 [info ] [Thread-1 (]: 9 of 11 START sql table model customer.inventory_status ........................ [RUN]
[0m17:57:26.953958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now model.retail_ops.inventory_status)
[0m17:57:26.954265 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m17:57:26.956907 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m17:57:26.957473 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m17:57:26.960321 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.inventory_status"
[0m17:57:26.961030 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:57:26.961305 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: BEGIN
[0m17:57:26.961557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.962035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.962292 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:57:26.962594 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."inventory_status__dbt_tmp"
  
    as (
      

WITH inventory_metrics AS (
    SELECT 
        i.inventory_id,
        i.warehouse_location,
        p.product_id,
        p.product_name,
        p.category,
        i.quantity_on_hand,
        i.reorder_point,
        i.last_restock_date,
        CASE 
            WHEN i.quantity_on_hand <= i.reorder_point THEN 'Reorder Required'
            WHEN i.quantity_on_hand <= (i.reorder_point * 1.5) THEN 'Low Stock'
            ELSE 'Sufficient Stock'
        END as stock_status
    FROM "retail_warehouse"."customer"."stg_inventory" i
    JOIN "retail_warehouse"."customer"."stg_products" p ON i.product_id = p.product_id
)

SELECT * FROM inventory_metrics
    );
  
  
[0m17:57:26.968419 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:57:26.971151 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:57:26.971476 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status__dbt_tmp" rename to "inventory_status"
[0m17:57:26.972016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.974732 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m17:57:26.975079 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:57:26.975350 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m17:57:26.976127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.978063 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:57:26.978372 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
drop table if exists "retail_warehouse"."customer"."inventory_status__dbt_backup" cascade
[0m17:57:26.978989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:26.980268 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: Close
[0m17:57:26.980721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc7170>]}
[0m17:57:26.981215 [info ] [Thread-1 (]: 9 of 11 OK created sql table model customer.inventory_status ................... [[32mOK[0m in 0.03s]
[0m17:57:26.981656 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m17:57:26.981956 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m17:57:26.982326 [info ] [Thread-1 (]: 10 of 11 START sql table model customer.customer_orders ........................ [RUN]
[0m17:57:26.982643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.customer_360.customer_orders)
[0m17:57:26.982920 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m17:57:26.985689 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m17:57:26.986343 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m17:57:26.989515 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_orders"
[0m17:57:26.990352 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:57:26.990740 [debug] [Thread-1 (]: On model.customer_360.customer_orders: BEGIN
[0m17:57:26.991173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:26.991779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:26.992062 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:57:26.992388 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_orders__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        customer_segment
    FROM "retail_warehouse"."customer"."stg_customers"
),

retail_sales AS (
    SELECT
        sale_id,
        customer_id,
        sale_date,
        total_amount
    FROM "retail_warehouse"."customer"."stg_sales"
),

customer_orders AS (
    SELECT
        c.customer_id,
        c.first_name,
        c.last_name,
        c.email,
        c.customer_segment,
        COUNT(s.sale_id) AS order_count,
        SUM(s.total_amount) AS total_spend,
        MIN(s.sale_date) AS first_order_date,
        MAX(s.sale_date) AS most_recent_order_date
    FROM customers c
    LEFT JOIN retail_sales s ON c.customer_id = s.customer_id
    GROUP BY 1, 2, 3, 4, 5
)

SELECT * FROM customer_orders
    );
  
  
[0m17:57:26.998495 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_orders__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        customer_segment
    FROM "retail_warehouse"."customer"."stg_customers"
),

retail_sales AS (
    SELECT
        sale_id,
        customer_id,
        sale_date,
        total_amount
    FROM "retail_warehouse"."customer"."stg_sales"
),

customer_orders AS (
    SELECT
        c.customer_id,
        c.first_name,
        c.last_name,
        c.email,
        c.customer_segment,
        COUNT(s.sale_id) AS order_count,
        SUM(s.total_amount) AS total_spend,
        MIN(s.sale_date) AS first_order_date,
        MAX(s.sale_date) AS most_recent_order_date
    FROM customers c
    LEFT JOIN retail_sales s ON c.customer_id = s.customer_id
    GROUP BY 1, 2, 3, 4, 5
)

SELECT * FROM customer_orders
    );
  
  
[0m17:57:26.998986 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:26.999420 [debug] [Thread-1 (]: On model.customer_360.customer_orders: ROLLBACK
[0m17:57:27.008737 [debug] [Thread-1 (]: Failed to rollback 'model.customer_360.customer_orders'
[0m17:57:27.009135 [debug] [Thread-1 (]: On model.customer_360.customer_orders: Close
[0m17:57:27.011478 [debug] [Thread-1 (]: Runtime Error in model customer_orders (models/marts/customer_orders.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 40:         SUM(s.total_amount) AS total_spend,
                   ^
[0m17:57:27.011898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d96060>]}
[0m17:57:27.012401 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model customer.customer_orders ............... [[31mERROR[0m in 0.03s]
[0m17:57:27.012911 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m17:57:27.013277 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m17:57:27.013719 [debug] [Thread-4 (]: Marking all children of 'model.customer_360.customer_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model customer_orders (models/marts/customer_orders.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 40:         SUM(s.total_amount) AS total_spend,
                   ^.
[0m17:57:27.014123 [info ] [Thread-1 (]: 11 of 11 START sql table model customer.product_sales .......................... [RUN]
[0m17:57:27.015121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.retail_ops.product_sales)
[0m17:57:27.015419 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m17:57:27.018163 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m17:57:27.018809 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m17:57:27.021580 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.product_sales"
[0m17:57:27.022182 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:57:27.022467 [debug] [Thread-1 (]: On model.retail_ops.product_sales: BEGIN
[0m17:57:27.022729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:27.023221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:27.023485 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:57:27.023793 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."product_sales__dbt_tmp"
  
    as (
      

WITH product_sales AS (
    SELECT 
        s.sale_id,
        s.customer_id,
        p.product_id,
        p.product_name,
        p.category,
        s.quantity,
        s.sale_date,
        s.total_amount
    FROM "retail_warehouse"."customer"."stg_sales" s
    JOIN "retail_warehouse"."customer"."stg_products" p ON s.product_id = p.product_id
)

SELECT * FROM product_sales
    );
  
  
[0m17:57:27.026155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:27.028831 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:57:27.029158 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales__dbt_tmp" rename to "product_sales"
[0m17:57:27.029759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:27.031053 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m17:57:27.031353 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:57:27.031619 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m17:57:27.032286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:27.034477 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:57:27.034815 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
drop table if exists "retail_warehouse"."customer"."product_sales__dbt_backup" cascade
[0m17:57:27.035357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:27.036387 [debug] [Thread-1 (]: On model.retail_ops.product_sales: Close
[0m17:57:27.036812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fde0c5-9bd0-4b1e-8cf6-482d2a7e503a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d56b70>]}
[0m17:57:27.037289 [info ] [Thread-1 (]: 11 of 11 OK created sql table model customer.product_sales ..................... [[32mOK[0m in 0.02s]
[0m17:57:27.037719 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m17:57:27.038639 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:27.039038 [debug] [MainThread]: On master: BEGIN
[0m17:57:27.039334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:27.039813 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:27.040060 [debug] [MainThread]: On master: COMMIT
[0m17:57:27.040292 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:27.040510 [debug] [MainThread]: On master: COMMIT
[0m17:57:27.040849 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:27.041120 [debug] [MainThread]: On master: Close
[0m17:57:27.041457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:27.041685 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m17:57:27.041994 [info ] [MainThread]: 
[0m17:57:27.042263 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m17:57:27.043795 [debug] [MainThread]: Command end result
[0m17:57:27.100127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:57:27.101430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:57:27.106375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m17:57:27.106665 [info ] [MainThread]: 
[0m17:57:27.106970 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:57:27.107221 [info ] [MainThread]: 
[0m17:57:27.107535 [error] [MainThread]:   Runtime Error in model customer_orders (models/marts/customer_orders.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 40:         SUM(s.total_amount) AS total_spend,
                   ^
[0m17:57:27.107807 [info ] [MainThread]: 
[0m17:57:27.108059 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m17:57:27.109480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1123618, "process_in_blocks": "0", "process_kernel_time": 0.241782, "process_mem_max_rss": "144867328", "process_out_blocks": "0", "process_user_time": 2.056707}
[0m17:57:27.109811 [debug] [MainThread]: Command `dbt run` failed at 17:57:27.109743 after 1.11 seconds
[0m17:57:27.110108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11010>]}
[0m17:57:27.110393 [debug] [MainThread]: Flushing usage events
[0m17:57:28.861455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:11.084175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ae960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106617bc0>]}


============================== 17:58:11.089332 | 77d77540-0584-45ac-8286-26e05d27d9f5 ==============================
[0m17:58:11.089332 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:58:11.089866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/telvin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:58:11.105079 [info ] [MainThread]: dbt version: 1.9.3
[0m17:58:11.105502 [info ] [MainThread]: python version: 3.12.8
[0m17:58:11.105764 [info ] [MainThread]: python path: /Users/telvin/miniforge3/bin/python3
[0m17:58:11.106001 [info ] [MainThread]: os info: macOS-14.6-arm64-arm-64bit
[0m17:58:11.213481 [info ] [MainThread]: Using profiles dir at /Users/telvin/.dbt
[0m17:58:11.213917 [info ] [MainThread]: Using profiles.yml file at /Users/telvin/.dbt/profiles.yml
[0m17:58:11.214266 [info ] [MainThread]: Using dbt_project.yml file at /Users/telvin/Desktop/dbt/dbt_projects/customer_360/dbt_project.yml
[0m17:58:11.217964 [info ] [MainThread]: adapter type: duckdb
[0m17:58:11.218292 [info ] [MainThread]: adapter version: 1.9.2
[0m17:58:11.299259 [info ] [MainThread]: Configuration:
[0m17:58:11.299694 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:58:11.299970 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:58:11.300215 [info ] [MainThread]: Required dependencies:
[0m17:58:11.300575 [debug] [MainThread]: Executing "git --help"
[0m17:58:11.319854 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:58:11.320704 [debug] [MainThread]: STDERR: "b''"
[0m17:58:11.321055 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:58:11.321465 [info ] [MainThread]: Connection:
[0m17:58:11.321867 [info ] [MainThread]:   database: retail_warehouse
[0m17:58:11.322140 [info ] [MainThread]:   schema: customer
[0m17:58:11.322403 [info ] [MainThread]:   path: /Users/telvin/Desktop/dbt/dbt_projects/data/retail_warehouse.duckdb
[0m17:58:11.322671 [info ] [MainThread]:   config_options: None
[0m17:58:11.322897 [info ] [MainThread]:   extensions: None
[0m17:58:11.323145 [info ] [MainThread]:   settings: {}
[0m17:58:11.323367 [info ] [MainThread]:   external_root: .
[0m17:58:11.323581 [info ] [MainThread]:   use_credential_provider: None
[0m17:58:11.323795 [info ] [MainThread]:   attach: None
[0m17:58:11.324003 [info ] [MainThread]:   filesystems: None
[0m17:58:11.324212 [info ] [MainThread]:   remote: None
[0m17:58:11.324427 [info ] [MainThread]:   plugins: None
[0m17:58:11.324636 [info ] [MainThread]:   disable_transactions: False
[0m17:58:11.325156 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:58:11.399060 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:58:11.431955 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:58:11.432314 [debug] [MainThread]: On debug: select 1 as id
[0m17:58:11.432583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:11.444892 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m17:58:11.445766 [debug] [MainThread]: On debug: Close
[0m17:58:11.446087 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:58:11.446386 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:58:11.448190 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4194506, "process_in_blocks": "0", "process_kernel_time": 0.206006, "process_mem_max_rss": "126795776", "process_out_blocks": "0", "process_user_time": 1.377902}
[0m17:58:11.448628 [debug] [MainThread]: Command `dbt debug` succeeded at 17:58:11.448536 after 0.42 seconds
[0m17:58:11.448923 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:58:11.449252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067349e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b14620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067942c0>]}
[0m17:58:11.449607 [debug] [MainThread]: Flushing usage events
[0m17:58:12.574591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:15.478572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be19d0>]}


============================== 17:58:15.483397 | b7b53fc2-dd40-407c-8444-dc1699ae2170 ==============================
[0m17:58:15.483397 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:58:15.483940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'profiles_dir': '/Users/telvin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:15.675613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108757170>]}
[0m17:58:15.725409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108455e80>]}
[0m17:58:15.729452 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:58:15.813607 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:58:15.933824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:15.934411 [debug] [MainThread]: Partial parsing: updated file: customer_360://models/marts/customer_orders.sql
[0m17:58:16.158839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bea80>]}
[0m17:58:16.228089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:58:16.229836 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:58:16.244561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d97c80>]}
[0m17:58:16.245004 [info ] [MainThread]: Found 11 models, 6 data tests, 9 sources, 426 macros
[0m17:58:16.245309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a70980>]}
[0m17:58:16.247138 [info ] [MainThread]: 
[0m17:58:16.247460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:16.247703 [info ] [MainThread]: 
[0m17:58:16.248098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:16.252612 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse'
[0m17:58:16.291928 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse"
[0m17:58:16.292334 [debug] [ThreadPool]: On list_retail_warehouse: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"retail_warehouse"'
    
  
  
[0m17:58:16.292630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:16.304705 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:58:16.305928 [debug] [ThreadPool]: On list_retail_warehouse: Close
[0m17:58:16.306521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_warehouse, now create_retail_warehouse_customer)
[0m17:58:16.306960 [debug] [ThreadPool]: Creating schema "database: "retail_warehouse"
schema: "customer"
"
[0m17:58:16.313013 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:58:16.313337 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
        select type from duckdb_databases()
        where lower(database_name)='retail_warehouse'
        and type='sqlite'
    
  
[0m17:58:16.313597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:16.314299 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:16.315366 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:58:16.315614 [debug] [ThreadPool]: On create_retail_warehouse_customer: BEGIN
[0m17:58:16.315943 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:16.316162 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:58:16.316397 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
    
        create schema if not exists "retail_warehouse"."customer"
    
[0m17:58:16.316778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:16.317482 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m17:58:16.317733 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m17:58:16.317953 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m17:58:16.318263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:16.318484 [debug] [ThreadPool]: On create_retail_warehouse_customer: Close
[0m17:58:16.319736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_warehouse_customer, now list_retail_warehouse_customer)
[0m17:58:16.324523 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:58:16.324827 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m17:58:16.325065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:16.325460 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:16.325702 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:58:16.325953 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m17:58:16.341971 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m17:58:16.343246 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m17:58:16.345448 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m17:58:16.345728 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m17:58:16.347589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6b950>]}
[0m17:58:16.347972 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:16.348219 [debug] [MainThread]: On master: BEGIN
[0m17:58:16.348440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:16.348804 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:16.349053 [debug] [MainThread]: On master: COMMIT
[0m17:58:16.349294 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:16.349512 [debug] [MainThread]: On master: COMMIT
[0m17:58:16.349850 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:16.350111 [debug] [MainThread]: On master: Close
[0m17:58:16.352079 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m17:58:16.352488 [info ] [Thread-1 (]: 1 of 11 START sql view model customer.stg_customer_feedback .................... [RUN]
[0m17:58:16.352838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m17:58:16.353132 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m17:58:16.359322 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m17:58:16.360013 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m17:58:16.389096 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_feedback"
[0m17:58:16.389959 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.390320 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: BEGIN
[0m17:58:16.390608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.391139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.391417 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.391705 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */

  
  create view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" as (
    

SELECT
    feedback_id,
    customer_id,
    sale_id,
    rating,
    feedback_text,
    feedback_date
FROM customer.raw_customer_feedback
  );

[0m17:58:16.392268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.397768 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.398133 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback" rename to "stg_customer_feedback__dbt_backup"
[0m17:58:16.398624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.400948 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.401259 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" rename to "stg_customer_feedback"
[0m17:58:16.401814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.412466 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m17:58:16.412838 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.413138 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m17:58:16.413967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.419253 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m17:58:16.419613 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_feedback__dbt_backup" cascade
[0m17:58:16.420239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.422278 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: Close
[0m17:58:16.423806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c89ee0>]}
[0m17:58:16.424327 [info ] [Thread-1 (]: 1 of 11 OK created sql view model customer.stg_customer_feedback ............... [[32mOK[0m in 0.07s]
[0m17:58:16.424790 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m17:58:16.425117 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m17:58:16.425532 [info ] [Thread-1 (]: 2 of 11 START sql view model customer.stg_customer_preferences ................. [RUN]
[0m17:58:16.425869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m17:58:16.426156 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m17:58:16.428292 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m17:58:16.428876 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m17:58:16.431812 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_preferences"
[0m17:58:16.432545 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.432854 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: BEGIN
[0m17:58:16.433129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.433637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.433911 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.434198 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */

  
  create view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" as (
    

SELECT
    preference_id,
    customer_id,
    preferred_category,
    communication_channel,
    last_updated
FROM customer.raw_customer_preferences
  );

[0m17:58:16.434762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.437342 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.437677 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences" rename to "stg_customer_preferences__dbt_backup"
[0m17:58:16.438476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.441047 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.441361 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" rename to "stg_customer_preferences"
[0m17:58:16.441848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.443111 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m17:58:16.443408 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.443673 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m17:58:16.444218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.446322 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m17:58:16.446684 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_preferences__dbt_backup" cascade
[0m17:58:16.447323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.448401 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: Close
[0m17:58:16.448840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6c290>]}
[0m17:58:16.449347 [info ] [Thread-1 (]: 2 of 11 OK created sql view model customer.stg_customer_preferences ............ [[32mOK[0m in 0.02s]
[0m17:58:16.449788 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m17:58:16.450098 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m17:58:16.450493 [info ] [Thread-1 (]: 3 of 11 START sql view model customer.stg_customers ............................ [RUN]
[0m17:58:16.450815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m17:58:16.451097 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m17:58:16.453329 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m17:58:16.453897 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m17:58:16.456805 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customers"
[0m17:58:16.457405 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.457704 [debug] [Thread-1 (]: On model.customer_360.stg_customers: BEGIN
[0m17:58:16.457968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.458480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.458847 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.459160 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */

  
  create view "retail_warehouse"."customer"."stg_customers__dbt_tmp" as (
    

SELECT
    customer_id,
    first_name,
    last_name,
    email,
    signup_date,
    customer_segment
FROM customer.raw_customers
  );

[0m17:58:16.459742 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.462400 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.462750 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:58:16.463406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.466188 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.466507 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:58:16.467036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.468464 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m17:58:16.468759 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.469024 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m17:58:16.469563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.471487 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m17:58:16.471975 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
drop view if exists "retail_warehouse"."customer"."stg_customers__dbt_backup" cascade
[0m17:58:16.472581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.473652 [debug] [Thread-1 (]: On model.customer_360.stg_customers: Close
[0m17:58:16.474075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109274d10>]}
[0m17:58:16.474563 [info ] [Thread-1 (]: 3 of 11 OK created sql view model customer.stg_customers ....................... [[32mOK[0m in 0.02s]
[0m17:58:16.474999 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m17:58:16.475307 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m17:58:16.475734 [info ] [Thread-1 (]: 4 of 11 START sql view model customer.stg_inventory ............................ [RUN]
[0m17:58:16.476200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m17:58:16.476574 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m17:58:16.478724 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m17:58:16.479328 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m17:58:16.483526 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_inventory"
[0m17:58:16.484181 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.484466 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: BEGIN
[0m17:58:16.484725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.485213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.485476 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.485750 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */

  
  create view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" as (
    

SELECT
    inventory_id,
    product_id,
    warehouse_location,
    quantity_on_hand,
    reorder_point,
    last_restock_date
FROM retail.raw_inventory
  );

[0m17:58:16.486294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.488943 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.489281 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m17:58:16.490186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.492670 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.492975 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m17:58:16.493554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.494798 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m17:58:16.495087 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.495351 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m17:58:16.495898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.497911 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m17:58:16.498296 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
drop view if exists "retail_warehouse"."customer"."stg_inventory__dbt_backup" cascade
[0m17:58:16.498998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.500123 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: Close
[0m17:58:16.500544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918cd70>]}
[0m17:58:16.501028 [info ] [Thread-1 (]: 4 of 11 OK created sql view model customer.stg_inventory ....................... [[32mOK[0m in 0.02s]
[0m17:58:16.501470 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m17:58:16.501783 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m17:58:16.502158 [info ] [Thread-1 (]: 5 of 11 START sql view model customer.stg_products ............................. [RUN]
[0m17:58:16.502481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m17:58:16.502757 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m17:58:16.504845 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m17:58:16.505479 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m17:58:16.508493 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_products"
[0m17:58:16.509199 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.509535 [debug] [Thread-1 (]: On model.retail_ops.stg_products: BEGIN
[0m17:58:16.509826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.510336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.510648 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.510951 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */

  
  create view "retail_warehouse"."customer"."stg_products__dbt_tmp" as (
    

SELECT * FROM retail.raw_products
  );

[0m17:58:16.511503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.514257 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.514607 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products" rename to "stg_products__dbt_backup"
[0m17:58:16.515151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.518034 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.518390 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:58:16.518957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.520300 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m17:58:16.520599 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.520867 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m17:58:16.521408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.523402 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m17:58:16.523720 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
drop view if exists "retail_warehouse"."customer"."stg_products__dbt_backup" cascade
[0m17:58:16.524280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.525376 [debug] [Thread-1 (]: On model.retail_ops.stg_products: Close
[0m17:58:16.525822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918a510>]}
[0m17:58:16.526312 [info ] [Thread-1 (]: 5 of 11 OK created sql view model customer.stg_products ........................ [[32mOK[0m in 0.02s]
[0m17:58:16.526747 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m17:58:16.527057 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m17:58:16.527452 [info ] [Thread-1 (]: 6 of 11 START sql view model customer.stg_promotions ........................... [RUN]
[0m17:58:16.527819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m17:58:16.528094 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m17:58:16.530217 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m17:58:16.530791 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m17:58:16.533775 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_promotions"
[0m17:58:16.534403 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.534721 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: BEGIN
[0m17:58:16.535006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.535518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.535781 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.536061 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */

  
  create view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" as (
    

SELECT
    promotion_id,
    product_id,
    promotion_name,
    discount_percentage,
    start_date,
    end_date
FROM retail.raw_promotions
  );

[0m17:58:16.536619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.540632 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.541016 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m17:58:16.541624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.581655 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.582108 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m17:58:16.582717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.584194 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m17:58:16.584513 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.584793 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m17:58:16.585337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.587273 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m17:58:16.587569 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
drop view if exists "retail_warehouse"."customer"."stg_promotions__dbt_backup" cascade
[0m17:58:16.588114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.589268 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: Close
[0m17:58:16.589718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b7020>]}
[0m17:58:16.590220 [info ] [Thread-1 (]: 6 of 11 OK created sql view model customer.stg_promotions ...................... [[32mOK[0m in 0.06s]
[0m17:58:16.590673 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m17:58:16.590991 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m17:58:16.591360 [info ] [Thread-1 (]: 7 of 11 START sql view model customer.stg_sales ................................ [RUN]
[0m17:58:16.591683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m17:58:16.591961 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m17:58:16.594131 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m17:58:16.594753 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m17:58:16.597604 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_sales"
[0m17:58:16.598298 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.598601 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: BEGIN
[0m17:58:16.598868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.599402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.599670 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.599950 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */

  
  create view "retail_warehouse"."customer"."stg_sales__dbt_tmp" as (
    

SELECT
    sale_id,
    product_id,
    customer_id,
    quantity,
    sale_date,
    total_amount
FROM retail.raw_sales
  );

[0m17:58:16.600586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.603355 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.603739 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:58:16.604619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.607533 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.607865 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:58:16.608409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.609702 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m17:58:16.609992 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.610253 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m17:58:16.610787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.612759 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m17:58:16.613071 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
drop view if exists "retail_warehouse"."customer"."stg_sales__dbt_backup" cascade
[0m17:58:16.613584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.614642 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: Close
[0m17:58:16.615076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092664e0>]}
[0m17:58:16.615578 [info ] [Thread-1 (]: 7 of 11 OK created sql view model customer.stg_sales ........................... [[32mOK[0m in 0.02s]
[0m17:58:16.616062 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m17:58:16.616370 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m17:58:16.616821 [info ] [Thread-1 (]: 8 of 11 START sql table model customer.customer_orders ......................... [RUN]
[0m17:58:16.617310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now model.customer_360.customer_orders)
[0m17:58:16.617643 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m17:58:16.620267 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m17:58:16.620883 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m17:58:16.639161 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_orders"
[0m17:58:16.639993 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:58:16.640313 [debug] [Thread-1 (]: On model.customer_360.customer_orders: BEGIN
[0m17:58:16.640598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.641096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.641371 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:58:16.641698 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_orders__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        customer_segment
    FROM "retail_warehouse"."customer"."stg_customers"
),

retail_sales AS (
    SELECT
        customer_id,
        sale_id,
        sale_date,
        CAST(total_amount AS DECIMAL(10,2)) as total_amount
    FROM retail.raw_sales
),

customer_orders AS (
    SELECT
        c.customer_id,
        c.first_name,
        c.last_name,
        c.email,
        c.customer_segment,
        COUNT(s.sale_id) AS order_count,
        SUM(s.total_amount) AS total_spend,
        MIN(s.sale_date) AS first_order_date,
        MAX(s.sale_date) AS most_recent_order_date
    FROM customers c
    LEFT JOIN retail_sales s ON c.customer_id = s.customer_id
    GROUP BY 1, 2, 3, 4, 5
)

SELECT * FROM customer_orders
    );
  
  
[0m17:58:16.647686 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:58:16.650511 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:58:16.650838 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
alter table "retail_warehouse"."customer"."customer_orders__dbt_tmp" rename to "customer_orders"
[0m17:58:16.651392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.655714 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m17:58:16.656041 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:58:16.656326 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m17:58:16.656981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.658878 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m17:58:16.659170 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
drop table if exists "retail_warehouse"."customer"."customer_orders__dbt_backup" cascade
[0m17:58:16.659583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.660607 [debug] [Thread-1 (]: On model.customer_360.customer_orders: Close
[0m17:58:16.661034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e9820>]}
[0m17:58:16.661520 [info ] [Thread-1 (]: 8 of 11 OK created sql table model customer.customer_orders .................... [[32mOK[0m in 0.04s]
[0m17:58:16.661953 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m17:58:16.662266 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m17:58:16.662641 [info ] [Thread-1 (]: 9 of 11 START sql table model customer.customer_profile_360 .................... [RUN]
[0m17:58:16.662957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.customer_360.customer_profile_360)
[0m17:58:16.663234 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m17:58:16.667616 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m17:58:16.668255 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m17:58:16.671261 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_profile_360"
[0m17:58:16.671980 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.672298 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: BEGIN
[0m17:58:16.672578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.673107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.673404 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.673731 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_profile_360__dbt_tmp"
  
    as (
      

WITH customer_base AS (
    SELECT
        c.*,
        cp.preferred_category,
        cp.communication_channel
    FROM "retail_warehouse"."customer"."stg_customers" c
    LEFT JOIN "retail_warehouse"."customer"."stg_customer_preferences" cp ON c.customer_id = cp.customer_id
),

customer_feedback_agg AS (
    SELECT
        customer_id,
        AVG(rating) as avg_rating,
        COUNT(*) as total_feedback_count
    FROM "retail_warehouse"."customer"."stg_customer_feedback"
    GROUP BY customer_id
),

final_profile AS (
    SELECT
        cb.*,
        COALESCE(cf.avg_rating, 0) as average_rating,
        COALESCE(cf.total_feedback_count, 0) as feedback_count
    FROM customer_base cb
    LEFT JOIN customer_feedback_agg cf ON cb.customer_id = cf.customer_id
)

SELECT * FROM final_profile
    );
  
  
[0m17:58:16.677506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:16.680210 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.680539 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360" rename to "customer_profile_360__dbt_backup"
[0m17:58:16.681098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.683471 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.683776 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360__dbt_tmp" rename to "customer_profile_360"
[0m17:58:16.684297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.685842 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m17:58:16.686171 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.686458 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m17:58:16.687137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.689262 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m17:58:16.689580 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
drop table if exists "retail_warehouse"."customer"."customer_profile_360__dbt_backup" cascade
[0m17:58:16.690395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.691422 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: Close
[0m17:58:16.691848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109189400>]}
[0m17:58:16.692336 [info ] [Thread-1 (]: 9 of 11 OK created sql table model customer.customer_profile_360 ............... [[32mOK[0m in 0.03s]
[0m17:58:16.692768 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m17:58:16.693085 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m17:58:16.693471 [info ] [Thread-1 (]: 10 of 11 START sql table model customer.inventory_status ....................... [RUN]
[0m17:58:16.693790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now model.retail_ops.inventory_status)
[0m17:58:16.694068 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m17:58:16.696787 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m17:58:16.697392 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m17:58:16.700302 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.inventory_status"
[0m17:58:16.701069 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.701379 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: BEGIN
[0m17:58:16.701654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.702172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.702465 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.702782 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."inventory_status__dbt_tmp"
  
    as (
      

WITH inventory_metrics AS (
    SELECT 
        i.inventory_id,
        i.warehouse_location,
        p.product_id,
        p.product_name,
        p.category,
        i.quantity_on_hand,
        i.reorder_point,
        i.last_restock_date,
        CASE 
            WHEN i.quantity_on_hand <= i.reorder_point THEN 'Reorder Required'
            WHEN i.quantity_on_hand <= (i.reorder_point * 1.5) THEN 'Low Stock'
            ELSE 'Sufficient Stock'
        END as stock_status
    FROM "retail_warehouse"."customer"."stg_inventory" i
    JOIN "retail_warehouse"."customer"."stg_products" p ON i.product_id = p.product_id
)

SELECT * FROM inventory_metrics
    );
  
  
[0m17:58:16.705860 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:16.708539 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.708864 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status" rename to "inventory_status__dbt_backup"
[0m17:58:16.709391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.711812 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.712164 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status__dbt_tmp" rename to "inventory_status"
[0m17:58:16.712797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.714357 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m17:58:16.714667 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.714955 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m17:58:16.715597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.717551 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m17:58:16.717852 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
drop table if exists "retail_warehouse"."customer"."inventory_status__dbt_backup" cascade
[0m17:58:16.718434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.719459 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: Close
[0m17:58:16.719871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108941c70>]}
[0m17:58:16.720355 [info ] [Thread-1 (]: 10 of 11 OK created sql table model customer.inventory_status .................. [[32mOK[0m in 0.03s]
[0m17:58:16.720789 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m17:58:16.721098 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m17:58:16.721474 [info ] [Thread-1 (]: 11 of 11 START sql table model customer.product_sales .......................... [RUN]
[0m17:58:16.721798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.retail_ops.product_sales)
[0m17:58:16.722080 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m17:58:16.724726 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m17:58:16.725367 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m17:58:16.728180 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.product_sales"
[0m17:58:16.728796 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.729092 [debug] [Thread-1 (]: On model.retail_ops.product_sales: BEGIN
[0m17:58:16.729355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:16.729828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.730092 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.730383 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."product_sales__dbt_tmp"
  
    as (
      

WITH product_sales AS (
    SELECT 
        s.sale_id,
        s.customer_id,
        p.product_id,
        p.product_name,
        p.category,
        s.quantity,
        s.sale_date,
        s.total_amount
    FROM "retail_warehouse"."customer"."stg_sales" s
    JOIN "retail_warehouse"."customer"."stg_products" p ON s.product_id = p.product_id
)

SELECT * FROM product_sales
    );
  
  
[0m17:58:16.732012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.736121 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.736447 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales" rename to "product_sales__dbt_backup"
[0m17:58:16.736953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.739448 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.739784 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales__dbt_tmp" rename to "product_sales"
[0m17:58:16.740328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.741817 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m17:58:16.742130 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.742401 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m17:58:16.743635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:16.745982 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m17:58:16.746321 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
drop table if exists "retail_warehouse"."customer"."product_sales__dbt_backup" cascade
[0m17:58:16.747190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:16.748375 [debug] [Thread-1 (]: On model.retail_ops.product_sales: Close
[0m17:58:16.748826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b53fc2-dd40-407c-8444-dc1699ae2170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927fce0>]}
[0m17:58:16.749445 [info ] [Thread-1 (]: 11 of 11 OK created sql table model customer.product_sales ..................... [[32mOK[0m in 0.03s]
[0m17:58:16.750097 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m17:58:16.751217 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:16.751523 [debug] [MainThread]: On master: BEGIN
[0m17:58:16.751768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:16.752240 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:16.752481 [debug] [MainThread]: On master: COMMIT
[0m17:58:16.752713 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:16.752961 [debug] [MainThread]: On master: COMMIT
[0m17:58:16.753275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:16.753501 [debug] [MainThread]: On master: Close
[0m17:58:16.753794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:16.754009 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m17:58:16.754311 [info ] [MainThread]: 
[0m17:58:16.754579 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m17:58:16.756062 [debug] [MainThread]: Command end result
[0m17:58:16.775515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:58:16.776994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:58:16.783006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m17:58:16.783352 [info ] [MainThread]: 
[0m17:58:16.783661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:16.783906 [info ] [MainThread]: 
[0m17:58:16.784159 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:58:16.785391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3607498, "process_in_blocks": "0", "process_kernel_time": 0.2432, "process_mem_max_rss": "154402816", "process_out_blocks": "0", "process_user_time": 2.29225}
[0m17:58:16.785747 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:16.785679 after 1.36 seconds
[0m17:58:16.786044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4590>]}
[0m17:58:16.786332 [debug] [MainThread]: Flushing usage events
[0m17:58:18.308309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:49.351012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077684d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077699d0>]}


============================== 17:58:49.356338 | d6c4e355-2003-413e-8208-ac3d1dac85b3 ==============================
[0m17:58:49.356338 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:58:49.356900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'profiles_dir': '/Users/telvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:58:49.569724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b8470>]}
[0m17:58:49.617280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107712f90>]}
[0m17:58:49.621718 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:58:49.708284 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:58:49.827759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:49.828135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:49.866224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cfe30>]}
[0m17:58:49.887005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920e690>]}
[0m17:58:49.887445 [info ] [MainThread]: Found 11 models, 6 data tests, 9 sources, 426 macros
[0m17:58:49.887763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109407530>]}
[0m17:58:49.889667 [info ] [MainThread]: 
[0m17:58:49.889992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:49.890237 [info ] [MainThread]: 
[0m17:58:49.890619 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:49.895035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse_customer'
[0m17:58:49.942334 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:58:49.942715 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m17:58:49.942982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:50.017918 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:58:50.018337 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m17:58:50.018648 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m17:58:50.047949 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m17:58:50.049736 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m17:58:50.051210 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m17:58:50.051489 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m17:58:50.053349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c4e355-2003-413e-8208-ac3d1dac85b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871d640>]}
[0m17:58:50.055434 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m17:58:50.055843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m17:58:50.056225 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m17:58:50.062429 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m17:58:50.063086 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m17:58:50.063773 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m17:58:50.064099 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m17:58:50.064487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m17:58:50.064922 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m17:58:50.067134 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m17:58:50.068715 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m17:58:50.069308 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m17:58:50.069629 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m17:58:50.069974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m17:58:50.070290 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m17:58:50.072668 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m17:58:50.073262 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m17:58:50.074040 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m17:58:50.074354 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m17:58:50.074746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m17:58:50.075166 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m17:58:50.081552 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m17:58:50.085044 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m17:58:50.085745 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m17:58:50.086093 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m17:58:50.086468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m17:58:50.086980 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m17:58:50.089919 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m17:58:50.091974 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m17:58:50.092592 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m17:58:50.092923 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m17:58:50.093283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m17:58:50.093617 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m17:58:50.095948 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m17:58:50.096939 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m17:58:50.097463 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m17:58:50.097769 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m17:58:50.098088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m17:58:50.098364 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m17:58:50.100493 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m17:58:50.100954 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m17:58:50.101428 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m17:58:50.101727 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:58:50.102030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d)
[0m17:58:50.102327 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:58:50.112476 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d"
[0m17:58:50.113182 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:58:50.113877 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m17:58:50.114511 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:58:50.115036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d, now test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19)
[0m17:58:50.115412 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:58:50.121260 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19"
[0m17:58:50.121977 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:58:50.122555 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m17:58:50.122885 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:58:50.123252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19, now test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc)
[0m17:58:50.123574 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:58:50.127533 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc"
[0m17:58:50.128138 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:58:50.128655 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m17:58:50.128966 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:58:50.129300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc, now test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718)
[0m17:58:50.129588 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:58:50.132941 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718"
[0m17:58:50.133578 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:58:50.134185 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m17:58:50.134509 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m17:58:50.134892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718, now model.customer_360.customer_orders)
[0m17:58:50.135255 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m17:58:50.137832 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m17:58:50.138393 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m17:58:50.138908 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m17:58:50.139215 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m17:58:50.139524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.customer_360.customer_profile_360)
[0m17:58:50.139800 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m17:58:50.142534 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m17:58:50.143061 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m17:58:50.143563 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m17:58:50.143875 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:50.144182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:58:50.144458 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:50.147678 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:50.148202 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:50.148690 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:50.149000 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:58:50.149301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.customer_360.unique_stg_customers_customer_id.c7614daada)
[0m17:58:50.149575 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:58:50.152660 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customers_customer_id.c7614daada"
[0m17:58:50.153158 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:58:50.153645 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m17:58:50.153944 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m17:58:50.154239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customers_customer_id.c7614daada, now model.retail_ops.inventory_status)
[0m17:58:50.154512 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m17:58:50.158397 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m17:58:50.158941 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m17:58:50.159440 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m17:58:50.159737 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m17:58:50.160038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.retail_ops.product_sales)
[0m17:58:50.160305 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m17:58:50.162614 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m17:58:50.163075 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m17:58:50.163550 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m17:58:50.164324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:50.164630 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m17:58:50.166564 [debug] [MainThread]: Command end result
[0m17:58:50.235009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:58:50.236629 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:58:50.242124 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m17:58:50.253438 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m17:58:50.253713 [info ] [MainThread]: Building catalog
[0m17:58:50.263924 [debug] [ThreadPool]: Acquiring new duckdb connection 'retail_warehouse.information_schema'
[0m17:58:50.271145 [debug] [ThreadPool]: Using duckdb connection "retail_warehouse.information_schema"
[0m17:58:50.271604 [debug] [ThreadPool]: On retail_warehouse.information_schema: BEGIN
[0m17:58:50.271892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:50.272432 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:50.272683 [debug] [ThreadPool]: Using duckdb connection "retail_warehouse.information_schema"
[0m17:58:50.272993 [debug] [ThreadPool]: On retail_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "retail_warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'retail_warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'retail_warehouse'
    )
    select
        'retail_warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main') or upper(r.schema_name) = upper('customer'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m17:58:50.284342 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:58:50.305436 [debug] [ThreadPool]: On retail_warehouse.information_schema: ROLLBACK
[0m17:58:50.306380 [debug] [ThreadPool]: Failed to rollback 'retail_warehouse.information_schema'
[0m17:58:50.306652 [debug] [ThreadPool]: On retail_warehouse.information_schema: Close
[0m17:58:50.332380 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/catalog.json
[0m17:58:50.351115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m17:58:50.352268 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m17:58:50.352538 [info ] [MainThread]: Catalog written to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/catalog.json
[0m17:58:50.354403 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.060162, "process_in_blocks": "0", "process_kernel_time": 0.249649, "process_mem_max_rss": "142180352", "process_out_blocks": "0", "process_user_time": 1.88566}
[0m17:58:50.354831 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:58:50.354754 after 1.06 seconds
[0m17:58:50.355106 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:58:50.355333 [debug] [MainThread]: Connection 'retail_warehouse.information_schema' was properly closed.
[0m17:58:50.355615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849fec0>]}
[0m17:58:50.355913 [debug] [MainThread]: Flushing usage events
[0m17:58:51.897337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:18.971285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c1970>]}


============================== 21:45:18.977496 | 06da7a92-c179-41fd-af1d-2bfea05d07eb ==============================
[0m21:45:18.977496 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:45:18.978032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:19.168696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06da7a92-c179-41fd-af1d-2bfea05d07eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105130320>]}
[0m21:45:19.216329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06da7a92-c179-41fd-af1d-2bfea05d07eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e3f0>]}
[0m21:45:19.220098 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m21:45:19.291753 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:45:19.293368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3760612, "process_in_blocks": "0", "process_kernel_time": 0.178776, "process_mem_max_rss": "110968832", "process_out_blocks": "0", "process_user_time": 1.408873}
[0m21:45:19.293786 [debug] [MainThread]: Command `dbt run` failed at 21:45:19.293697 after 0.38 seconds
[0m21:45:19.294192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10148ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104592cf0>]}
[0m21:45:19.294558 [debug] [MainThread]: Flushing usage events
[0m21:45:20.572338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:19.548507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ace870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ead970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ead8e0>]}


============================== 21:50:19.553496 | 43212b33-9e9d-48a3-a48c-f48b24a50a5e ==============================
[0m21:50:19.553496 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:50:19.554095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:50:19.746203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43212b33-9e9d-48a3-a48c-f48b24a50a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11061d940>]}
[0m21:50:19.795430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43212b33-9e9d-48a3-a48c-f48b24a50a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7bf80>]}
[0m21:50:19.799394 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m21:50:19.870552 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:50:19.872191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3796642, "process_in_blocks": "0", "process_kernel_time": 0.180999, "process_mem_max_rss": "110968832", "process_out_blocks": "0", "process_user_time": 1.409458}
[0m21:50:19.872616 [debug] [MainThread]: Command `dbt run` failed at 21:50:19.872526 after 0.38 seconds
[0m21:50:19.873010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10348de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110407d40>]}
[0m21:50:19.873358 [debug] [MainThread]: Flushing usage events
[0m21:50:21.123582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:50.485856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107076900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3bc0>]}


============================== 21:50:50.491210 | 29b813a7-bf77-4f1b-badb-891ae769e7bd ==============================
[0m21:50:50.491210 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:50:50.491771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:50:50.603259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b813a7-bf77-4f1b-badb-891ae769e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070763f0>]}
[0m21:50:50.616164 [debug] [MainThread]: Set downloads directory='/var/folders/0h/c1fdg6917qg28vb3365bqjxh0000gn/T/dbt-downloads-ndc6s3mr'
[0m21:50:50.616585 [info ] [MainThread]: Installing ../retail_ops
[0m21:50:50.617192 [debug] [MainThread]: Creating symlink to local dependency.
[0m21:50:50.617526 [info ] [MainThread]: Installed from <local @ ../retail_ops>
[0m21:50:50.617842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '29b813a7-bf77-4f1b-badb-891ae769e7bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734bb30>]}
[0m21:50:50.619277 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19182533, "process_in_blocks": "0", "process_kernel_time": 0.155535, "process_mem_max_rss": "102334464", "process_out_blocks": "0", "process_user_time": 1.263377}
[0m21:50:50.619725 [debug] [MainThread]: Command `dbt deps` succeeded at 21:50:50.619632 after 0.19 seconds
[0m21:50:50.620046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107304590>]}
[0m21:50:50.620357 [debug] [MainThread]: Flushing usage events
[0m21:50:51.634734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:53.118311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11289ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11289fbf0>]}


============================== 21:50:53.124078 | 95a9c72c-a36f-4360-aa21-419cb448e2c4 ==============================
[0m21:50:53.124078 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:50:53.124648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:53.321189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129292e0>]}
[0m21:50:53.376407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c3e90>]}
[0m21:50:53.380930 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m21:50:53.463527 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:50:53.464321 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:50:53.464666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e8f170>]}
[0m21:50:54.598122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c1ee0>]}
[0m21:50:54.672542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:50:54.674107 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:50:54.690517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129dde80>]}
[0m21:50:54.690976 [info ] [MainThread]: Found 11 models, 6 data tests, 16 sources, 426 macros
[0m21:50:54.691278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112de3ec0>]}
[0m21:50:54.693122 [info ] [MainThread]: 
[0m21:50:54.693438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:54.693677 [info ] [MainThread]: 
[0m21:50:54.694053 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:54.698518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse'
[0m21:50:54.743508 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse"
[0m21:50:54.743886 [debug] [ThreadPool]: On list_retail_warehouse: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"retail_warehouse"'
    
  
  
[0m21:50:54.744155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:54.758333 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:50:54.759637 [debug] [ThreadPool]: On list_retail_warehouse: Close
[0m21:50:54.760201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_warehouse, now create_retail_warehouse_customer)
[0m21:50:54.760588 [debug] [ThreadPool]: Creating schema "database: "retail_warehouse"
schema: "customer"
"
[0m21:50:54.766659 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:50:54.766991 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
        select type from duckdb_databases()
        where lower(database_name)='retail_warehouse'
        and type='sqlite'
    
  
[0m21:50:54.767246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:54.767983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:54.769262 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:50:54.769593 [debug] [ThreadPool]: On create_retail_warehouse_customer: BEGIN
[0m21:50:54.770049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:54.770367 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:50:54.770631 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
    
        create schema if not exists "retail_warehouse"."customer"
    
[0m21:50:54.771060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:54.771871 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m21:50:54.772135 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:50:54.772366 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m21:50:54.772828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:54.773148 [debug] [ThreadPool]: On create_retail_warehouse_customer: Close
[0m21:50:54.774547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_warehouse_customer, now list_retail_warehouse_customer)
[0m21:50:54.780688 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:50:54.780997 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m21:50:54.781235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:54.781666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:54.781899 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:50:54.782151 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m21:50:54.798744 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:50:54.800140 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m21:50:54.801812 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m21:50:54.802099 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m21:50:54.804063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11289c350>]}
[0m21:50:54.804493 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:54.804738 [debug] [MainThread]: On master: BEGIN
[0m21:50:54.804961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:54.805442 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:54.805772 [debug] [MainThread]: On master: COMMIT
[0m21:50:54.806033 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:54.806271 [debug] [MainThread]: On master: COMMIT
[0m21:50:54.806611 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:54.806845 [debug] [MainThread]: On master: Close
[0m21:50:54.809141 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m21:50:54.809566 [info ] [Thread-1 (]: 1 of 11 START sql view model customer.stg_customer_feedback .................... [RUN]
[0m21:50:54.809927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m21:50:54.810210 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m21:50:54.816221 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m21:50:54.817245 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m21:50:54.846626 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_feedback"
[0m21:50:54.847797 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.848115 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: BEGIN
[0m21:50:54.848405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.848927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.849206 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.849494 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */

  
  create view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" as (
    

SELECT
    feedback_id,
    customer_id,
    sale_id,
    rating,
    feedback_text,
    feedback_date
FROM customer.raw_customer_feedback
  );

[0m21:50:54.850069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.855982 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.856416 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback" rename to "stg_customer_feedback__dbt_backup"
[0m21:50:54.857052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.859555 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.859870 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" rename to "stg_customer_feedback"
[0m21:50:54.860346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.871778 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m21:50:54.872224 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.872526 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m21:50:54.873458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.877730 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:50:54.878076 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_feedback__dbt_backup" cascade
[0m21:50:54.878689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.880770 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: Close
[0m21:50:54.882342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c0dd0>]}
[0m21:50:54.882878 [info ] [Thread-1 (]: 1 of 11 OK created sql view model customer.stg_customer_feedback ............... [[32mOK[0m in 0.07s]
[0m21:50:54.883347 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m21:50:54.883673 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m21:50:54.884082 [info ] [Thread-1 (]: 2 of 11 START sql view model customer.stg_customer_preferences ................. [RUN]
[0m21:50:54.884420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m21:50:54.884771 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m21:50:54.887298 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m21:50:54.888028 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m21:50:54.891039 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_preferences"
[0m21:50:54.891652 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.891949 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: BEGIN
[0m21:50:54.892248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.892752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.893023 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.893305 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */

  
  create view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" as (
    

SELECT
    preference_id,
    customer_id,
    preferred_category,
    communication_channel,
    last_updated
FROM customer.raw_customer_preferences
  );

[0m21:50:54.893856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.896339 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.896692 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences" rename to "stg_customer_preferences__dbt_backup"
[0m21:50:54.897209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.900897 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.901237 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" rename to "stg_customer_preferences"
[0m21:50:54.901826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.903490 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m21:50:54.903886 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.904227 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m21:50:54.904938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.907102 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:50:54.907452 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_preferences__dbt_backup" cascade
[0m21:50:54.908152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.909392 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: Close
[0m21:50:54.909824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ed8140>]}
[0m21:50:54.910311 [info ] [Thread-1 (]: 2 of 11 OK created sql view model customer.stg_customer_preferences ............ [[32mOK[0m in 0.03s]
[0m21:50:54.910742 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m21:50:54.911039 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m21:50:54.911417 [info ] [Thread-1 (]: 3 of 11 START sql view model customer.stg_customers ............................ [RUN]
[0m21:50:54.911729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m21:50:54.912003 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m21:50:54.914127 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m21:50:54.914779 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m21:50:54.917707 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customers"
[0m21:50:54.918700 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.919085 [debug] [Thread-1 (]: On model.customer_360.stg_customers: BEGIN
[0m21:50:54.919381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.919910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.920243 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.920550 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */

  
  create view "retail_warehouse"."customer"."stg_customers__dbt_tmp" as (
    

SELECT
    customer_id,
    first_name,
    last_name,
    email,
    signup_date,
    customer_segment
FROM customer.raw_customers
  );

[0m21:50:54.921180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.924037 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.924412 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:50:54.925586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.928217 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.928556 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:50:54.929093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.930551 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m21:50:54.930860 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.931141 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m21:50:54.931708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.933659 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:50:54.933951 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
drop view if exists "retail_warehouse"."customer"."stg_customers__dbt_backup" cascade
[0m21:50:54.934487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.935644 [debug] [Thread-1 (]: On model.customer_360.stg_customers: Close
[0m21:50:54.936104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e05b20>]}
[0m21:50:54.936655 [info ] [Thread-1 (]: 3 of 11 OK created sql view model customer.stg_customers ....................... [[32mOK[0m in 0.02s]
[0m21:50:54.937196 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m21:50:54.937525 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m21:50:54.937945 [info ] [Thread-1 (]: 4 of 11 START sql view model customer.stg_inventory ............................ [RUN]
[0m21:50:54.938376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m21:50:54.938699 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m21:50:54.940878 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m21:50:54.941727 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m21:50:54.944690 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_inventory"
[0m21:50:54.945467 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.945749 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: BEGIN
[0m21:50:54.946007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.946498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.946757 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.947028 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */

  
  create view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" as (
    

SELECT
    inventory_id,
    product_id,
    warehouse_location,
    quantity_on_hand,
    reorder_point,
    last_restock_date
FROM retail.raw_inventory
  );

[0m21:50:54.947574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.950089 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.950382 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m21:50:54.950841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.953399 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.953771 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m21:50:54.954368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.955703 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m21:50:54.956006 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.956485 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m21:50:54.957206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.960518 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:50:54.960866 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
drop view if exists "retail_warehouse"."customer"."stg_inventory__dbt_backup" cascade
[0m21:50:54.961585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.962744 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: Close
[0m21:50:54.963187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113efb260>]}
[0m21:50:54.963689 [info ] [Thread-1 (]: 4 of 11 OK created sql view model customer.stg_inventory ....................... [[32mOK[0m in 0.02s]
[0m21:50:54.964134 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m21:50:54.964439 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m21:50:54.964809 [info ] [Thread-1 (]: 5 of 11 START sql view model customer.stg_products ............................. [RUN]
[0m21:50:54.965141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m21:50:54.965417 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m21:50:54.967578 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m21:50:54.968265 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m21:50:54.971576 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_products"
[0m21:50:54.972377 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.972681 [debug] [Thread-1 (]: On model.retail_ops.stg_products: BEGIN
[0m21:50:54.972948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.973460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.973727 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.974001 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */

  
  create view "retail_warehouse"."customer"."stg_products__dbt_tmp" as (
    

SELECT * FROM retail.raw_products
  );

[0m21:50:54.974528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.977124 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.977423 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products" rename to "stg_products__dbt_backup"
[0m21:50:54.977876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.980189 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.980489 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:50:54.980935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.982237 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m21:50:54.982520 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.982782 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m21:50:54.983350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.985256 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:50:54.985594 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
drop view if exists "retail_warehouse"."customer"."stg_products__dbt_backup" cascade
[0m21:50:54.986240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.987351 [debug] [Thread-1 (]: On model.retail_ops.stg_products: Close
[0m21:50:54.987796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e05040>]}
[0m21:50:54.988316 [info ] [Thread-1 (]: 5 of 11 OK created sql view model customer.stg_products ........................ [[32mOK[0m in 0.02s]
[0m21:50:54.988763 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m21:50:54.989074 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m21:50:54.989487 [info ] [Thread-1 (]: 6 of 11 START sql view model customer.stg_promotions ........................... [RUN]
[0m21:50:54.989931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m21:50:54.990377 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m21:50:54.992782 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m21:50:54.993435 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m21:50:54.996296 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_promotions"
[0m21:50:54.996874 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:54.997179 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: BEGIN
[0m21:50:54.997460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.997979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.998242 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:54.998515 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */

  
  create view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" as (
    

SELECT
    promotion_id,
    product_id,
    promotion_name,
    discount_percentage,
    start_date,
    end_date
FROM retail.raw_promotions
  );

[0m21:50:54.999055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.001839 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:55.002191 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m21:50:55.002759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.005366 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:55.005756 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m21:50:55.006379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.007940 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m21:50:55.008673 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:55.008983 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m21:50:55.009634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.011654 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:50:55.011952 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
drop view if exists "retail_warehouse"."customer"."stg_promotions__dbt_backup" cascade
[0m21:50:55.012535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.013636 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: Close
[0m21:50:55.014080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea4e90>]}
[0m21:50:55.014563 [info ] [Thread-1 (]: 6 of 11 OK created sql view model customer.stg_promotions ...................... [[32mOK[0m in 0.02s]
[0m21:50:55.014997 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m21:50:55.015307 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m21:50:55.015680 [info ] [Thread-1 (]: 7 of 11 START sql view model customer.stg_sales ................................ [RUN]
[0m21:50:55.016008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m21:50:55.016282 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m21:50:55.018548 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m21:50:55.019269 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m21:50:55.024218 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_sales"
[0m21:50:55.025012 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.025304 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: BEGIN
[0m21:50:55.025565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:55.026061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.026327 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.026598 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */

  
  create view "retail_warehouse"."customer"."stg_sales__dbt_tmp" as (
    

SELECT
    sale_id,
    product_id,
    customer_id,
    quantity,
    sale_date,
    total_amount
FROM retail.raw_sales
  );

[0m21:50:55.027129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.029648 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.029952 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:50:55.030406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.032731 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.033026 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:50:55.033467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.034717 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m21:50:55.034999 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.035268 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m21:50:55.035980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.038102 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:50:55.038457 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
drop view if exists "retail_warehouse"."customer"."stg_sales__dbt_backup" cascade
[0m21:50:55.039094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.040462 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: Close
[0m21:50:55.040924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f31400>]}
[0m21:50:55.041414 [info ] [Thread-1 (]: 7 of 11 OK created sql view model customer.stg_sales ........................... [[32mOK[0m in 0.02s]
[0m21:50:55.041833 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m21:50:55.042133 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m21:50:55.042507 [info ] [Thread-1 (]: 8 of 11 START sql table model customer.customer_orders ......................... [RUN]
[0m21:50:55.042879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now model.customer_360.customer_orders)
[0m21:50:55.043152 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m21:50:55.045697 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m21:50:55.046443 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m21:50:55.064872 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_orders"
[0m21:50:55.065773 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.066086 [debug] [Thread-1 (]: On model.customer_360.customer_orders: BEGIN
[0m21:50:55.066364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:55.066884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:55.067153 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.067470 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_orders__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        customer_segment
    FROM "retail_warehouse"."customer"."stg_customers"
),

retail_sales AS (
    SELECT
        customer_id,
        sale_id,
        sale_date,
        CAST(total_amount AS DECIMAL(10,2)) as total_amount
    FROM retail.raw_sales
),

customer_orders AS (
    SELECT
        c.customer_id,
        c.first_name,
        c.last_name,
        c.email,
        c.customer_segment,
        COUNT(s.sale_id) AS order_count,
        SUM(s.total_amount) AS total_spend,
        MIN(s.sale_date) AS first_order_date,
        MAX(s.sale_date) AS most_recent_order_date
    FROM customers c
    LEFT JOIN retail_sales s ON c.customer_id = s.customer_id
    GROUP BY 1, 2, 3, 4, 5
)

SELECT * FROM customer_orders
    );
  
  
[0m21:50:55.074274 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:55.076898 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.077206 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
alter table "retail_warehouse"."customer"."customer_orders" rename to "customer_orders__dbt_backup"
[0m21:50:55.077808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.080436 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.080795 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
alter table "retail_warehouse"."customer"."customer_orders__dbt_tmp" rename to "customer_orders"
[0m21:50:55.081285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.086046 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m21:50:55.086448 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.086813 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m21:50:55.087627 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:55.089972 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:50:55.090309 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
drop table if exists "retail_warehouse"."customer"."customer_orders__dbt_backup" cascade
[0m21:50:55.091115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.092267 [debug] [Thread-1 (]: On model.customer_360.customer_orders: Close
[0m21:50:55.092729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea5310>]}
[0m21:50:55.093227 [info ] [Thread-1 (]: 8 of 11 OK created sql table model customer.customer_orders .................... [[32mOK[0m in 0.05s]
[0m21:50:55.093658 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m21:50:55.093965 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m21:50:55.094306 [info ] [Thread-1 (]: 9 of 11 START sql table model customer.customer_profile_360 .................... [RUN]
[0m21:50:55.094668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.customer_360.customer_profile_360)
[0m21:50:55.094952 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m21:50:55.097783 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m21:50:55.098413 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m21:50:55.101496 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_profile_360"
[0m21:50:55.102310 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.102627 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: BEGIN
[0m21:50:55.102907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:55.103426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:55.104127 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.104713 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_profile_360__dbt_tmp"
  
    as (
      

WITH customer_base AS (
    SELECT
        c.*,
        cp.preferred_category,
        cp.communication_channel
    FROM "retail_warehouse"."customer"."stg_customers" c
    LEFT JOIN "retail_warehouse"."customer"."stg_customer_preferences" cp ON c.customer_id = cp.customer_id
),

customer_feedback_agg AS (
    SELECT
        customer_id,
        AVG(rating) as avg_rating,
        COUNT(*) as total_feedback_count
    FROM "retail_warehouse"."customer"."stg_customer_feedback"
    GROUP BY customer_id
),

final_profile AS (
    SELECT
        cb.*,
        COALESCE(cf.avg_rating, 0) as average_rating,
        COALESCE(cf.total_feedback_count, 0) as feedback_count
    FROM customer_base cb
    LEFT JOIN customer_feedback_agg cf ON cb.customer_id = cf.customer_id
)

SELECT * FROM final_profile
    );
  
  
[0m21:50:55.107937 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:55.111918 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.112267 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360" rename to "customer_profile_360__dbt_backup"
[0m21:50:55.112824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.115092 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.115395 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360__dbt_tmp" rename to "customer_profile_360"
[0m21:50:55.115854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.117432 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m21:50:55.117731 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.117996 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m21:50:55.118782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.121142 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:50:55.121537 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
drop table if exists "retail_warehouse"."customer"."customer_profile_360__dbt_backup" cascade
[0m21:50:55.122319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.123425 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: Close
[0m21:50:55.123863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef9f40>]}
[0m21:50:55.124361 [info ] [Thread-1 (]: 9 of 11 OK created sql table model customer.customer_profile_360 ............... [[32mOK[0m in 0.03s]
[0m21:50:55.124804 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m21:50:55.125105 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m21:50:55.125476 [info ] [Thread-1 (]: 10 of 11 START sql table model customer.inventory_status ....................... [RUN]
[0m21:50:55.125793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now model.retail_ops.inventory_status)
[0m21:50:55.126063 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m21:50:55.128649 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m21:50:55.129353 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m21:50:55.132285 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.inventory_status"
[0m21:50:55.132966 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.133263 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: BEGIN
[0m21:50:55.133556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:55.134045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.134312 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.134620 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."inventory_status__dbt_tmp"
  
    as (
      

WITH inventory_metrics AS (
    SELECT 
        i.inventory_id,
        i.warehouse_location,
        p.product_id,
        p.product_name,
        p.category,
        i.quantity_on_hand,
        i.reorder_point,
        i.last_restock_date,
        CASE 
            WHEN i.quantity_on_hand <= i.reorder_point THEN 'Reorder Required'
            WHEN i.quantity_on_hand <= (i.reorder_point * 1.5) THEN 'Low Stock'
            ELSE 'Sufficient Stock'
        END as stock_status
    FROM "retail_warehouse"."customer"."stg_inventory" i
    JOIN "retail_warehouse"."customer"."stg_products" p ON i.product_id = p.product_id
)

SELECT * FROM inventory_metrics
    );
  
  
[0m21:50:55.137840 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:55.140564 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.140894 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status" rename to "inventory_status__dbt_backup"
[0m21:50:55.141464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.143711 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.144013 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status__dbt_tmp" rename to "inventory_status"
[0m21:50:55.144454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.146035 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m21:50:55.146326 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.146594 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m21:50:55.147221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.149166 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:50:55.149477 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
drop table if exists "retail_warehouse"."customer"."inventory_status__dbt_backup" cascade
[0m21:50:55.150088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.151169 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: Close
[0m21:50:55.151637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba6120>]}
[0m21:50:55.152213 [info ] [Thread-1 (]: 10 of 11 OK created sql table model customer.inventory_status .................. [[32mOK[0m in 0.03s]
[0m21:50:55.152731 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m21:50:55.153071 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m21:50:55.153469 [info ] [Thread-1 (]: 11 of 11 START sql table model customer.product_sales .......................... [RUN]
[0m21:50:55.153828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.retail_ops.product_sales)
[0m21:50:55.154114 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m21:50:55.156705 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m21:50:55.157332 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m21:50:55.160228 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.product_sales"
[0m21:50:55.160804 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.161097 [debug] [Thread-1 (]: On model.retail_ops.product_sales: BEGIN
[0m21:50:55.161358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:55.161854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.162126 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.162423 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."product_sales__dbt_tmp"
  
    as (
      

WITH product_sales AS (
    SELECT 
        s.sale_id,
        s.customer_id,
        p.product_id,
        p.product_name,
        p.category,
        s.quantity,
        s.sale_date,
        s.total_amount
    FROM "retail_warehouse"."customer"."stg_sales" s
    JOIN "retail_warehouse"."customer"."stg_products" p ON s.product_id = p.product_id
)

SELECT * FROM product_sales
    );
  
  
[0m21:50:55.164081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:55.166503 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.166812 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales" rename to "product_sales__dbt_backup"
[0m21:50:55.167323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.169791 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.170135 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales__dbt_tmp" rename to "product_sales"
[0m21:50:55.170698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.172301 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m21:50:55.172597 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.172932 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m21:50:55.173907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.176863 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:50:55.177168 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
drop table if exists "retail_warehouse"."customer"."product_sales__dbt_backup" cascade
[0m21:50:55.177809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.178898 [debug] [Thread-1 (]: On model.retail_ops.product_sales: Close
[0m21:50:55.179316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a9c72c-a36f-4360-aa21-419cb448e2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef6480>]}
[0m21:50:55.179788 [info ] [Thread-1 (]: 11 of 11 OK created sql table model customer.product_sales ..................... [[32mOK[0m in 0.03s]
[0m21:50:55.180209 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m21:50:55.181027 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:55.181284 [debug] [MainThread]: On master: BEGIN
[0m21:50:55.181507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:55.181941 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:55.182252 [debug] [MainThread]: On master: COMMIT
[0m21:50:55.182497 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:55.182720 [debug] [MainThread]: On master: COMMIT
[0m21:50:55.183121 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:55.183374 [debug] [MainThread]: On master: Close
[0m21:50:55.183716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:55.183944 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m21:50:55.184304 [info ] [MainThread]: 
[0m21:50:55.184881 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m21:50:55.186977 [debug] [MainThread]: Command end result
[0m21:50:55.207921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:50:55.209407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:50:55.215100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m21:50:55.215456 [info ] [MainThread]: 
[0m21:50:55.215770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:55.216023 [info ] [MainThread]: 
[0m21:50:55.216285 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m21:50:55.217767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1578076, "process_in_blocks": "0", "process_kernel_time": 0.285094, "process_mem_max_rss": "155140096", "process_out_blocks": "0", "process_user_time": 3.078938}
[0m21:50:55.218392 [debug] [MainThread]: Command `dbt run` succeeded at 21:50:55.218260 after 2.16 seconds
[0m21:50:55.219035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138378f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112de8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eee0c0>]}
[0m21:50:55.219409 [debug] [MainThread]: Flushing usage events
[0m21:50:56.559274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:54.447686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027376e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659fbc0>]}


============================== 21:51:54.452825 | bbe91cb0-1565-4eda-bf9b-12c85cafbcf6 ==============================
[0m21:51:54.452825 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:51:54.453432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:51:54.561823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe91cb0-1565-4eda-bf9b-12c85cafbcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb260>]}
[0m21:51:54.577641 [debug] [MainThread]: Set downloads directory='/var/folders/0h/c1fdg6917qg28vb3365bqjxh0000gn/T/dbt-downloads-mlebgqo6'
[0m21:51:54.578065 [info ] [MainThread]: Installing ../retail_ops
[0m21:51:54.578679 [debug] [MainThread]: Creating symlink to local dependency.
[0m21:51:54.579008 [info ] [MainThread]: Installed from <local @ ../retail_ops>
[0m21:51:54.579311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bbe91cb0-1565-4eda-bf9b-12c85cafbcf6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068018e0>]}
[0m21:51:54.580680 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19118321, "process_in_blocks": "0", "process_kernel_time": 0.154555, "process_mem_max_rss": "102678528", "process_out_blocks": "0", "process_user_time": 1.248391}
[0m21:51:54.581053 [debug] [MainThread]: Command `dbt deps` succeeded at 21:51:54.580977 after 0.19 seconds
[0m21:51:54.581346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ba630>]}
[0m21:51:54.581624 [debug] [MainThread]: Flushing usage events
[0m21:51:55.694951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:57.293740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfc50>]}


============================== 21:51:57.298415 | 70ff8c83-cedc-405b-9809-c515c8ba850e ==============================
[0m21:51:57.298415 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:51:57.298952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:51:57.495469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0c830>]}
[0m21:51:57.544269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eab70>]}
[0m21:51:57.548211 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m21:51:57.627766 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:51:57.734541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:57.735066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:57.775233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108938f50>]}
[0m21:51:57.848948 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:51:57.850615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:51:57.865920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2b890>]}
[0m21:51:57.866377 [info ] [MainThread]: Found 11 models, 6 data tests, 16 sources, 426 macros
[0m21:51:57.866696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b45220>]}
[0m21:51:57.868779 [info ] [MainThread]: 
[0m21:51:57.869140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:57.869404 [info ] [MainThread]: 
[0m21:51:57.869824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:51:57.874313 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse'
[0m21:51:57.918076 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse"
[0m21:51:57.918490 [debug] [ThreadPool]: On list_retail_warehouse: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"retail_warehouse"'
    
  
  
[0m21:51:57.918781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:57.932560 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:51:57.933818 [debug] [ThreadPool]: On list_retail_warehouse: Close
[0m21:51:57.934538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_warehouse, now create_retail_warehouse_customer)
[0m21:51:57.935032 [debug] [ThreadPool]: Creating schema "database: "retail_warehouse"
schema: "customer"
"
[0m21:51:57.941899 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:51:57.942348 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
        select type from duckdb_databases()
        where lower(database_name)='retail_warehouse'
        and type='sqlite'
    
  
[0m21:51:57.942717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:57.943640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:57.945268 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:51:57.945593 [debug] [ThreadPool]: On create_retail_warehouse_customer: BEGIN
[0m21:51:57.946096 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:57.946381 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:51:57.946638 [debug] [ThreadPool]: On create_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "create_retail_warehouse_customer"} */

    
    
        create schema if not exists "retail_warehouse"."customer"
    
[0m21:51:57.947075 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:57.947826 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m21:51:57.948089 [debug] [ThreadPool]: Using duckdb connection "create_retail_warehouse_customer"
[0m21:51:57.948347 [debug] [ThreadPool]: On create_retail_warehouse_customer: COMMIT
[0m21:51:57.948705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:57.948956 [debug] [ThreadPool]: On create_retail_warehouse_customer: Close
[0m21:51:57.950282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_warehouse_customer, now list_retail_warehouse_customer)
[0m21:51:57.955558 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:51:57.955920 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m21:51:57.956166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:57.956645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:57.956885 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:51:57.957140 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m21:51:57.973477 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:51:57.974874 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m21:51:57.975969 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m21:51:57.976227 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m21:51:57.978254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23860>]}
[0m21:51:57.978654 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:57.978904 [debug] [MainThread]: On master: BEGIN
[0m21:51:57.979127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:57.979563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:57.979827 [debug] [MainThread]: On master: COMMIT
[0m21:51:57.980342 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:57.980790 [debug] [MainThread]: On master: COMMIT
[0m21:51:57.981209 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:57.981542 [debug] [MainThread]: On master: Close
[0m21:51:57.983213 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m21:51:57.983667 [info ] [Thread-1 (]: 1 of 11 START sql view model customer.stg_customer_feedback .................... [RUN]
[0m21:51:57.984040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m21:51:57.984330 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m21:51:57.991810 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m21:51:57.992616 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m21:51:58.036580 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_feedback"
[0m21:51:58.037656 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.037990 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: BEGIN
[0m21:51:58.038269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.038817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.039091 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.039387 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */

  
  create view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" as (
    

SELECT
    feedback_id,
    customer_id,
    sale_id,
    rating,
    feedback_text,
    feedback_date
FROM customer.raw_customer_feedback
  );

[0m21:51:58.040010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.047653 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.048176 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback" rename to "stg_customer_feedback__dbt_backup"
[0m21:51:58.048814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.051762 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.052152 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
alter view "retail_warehouse"."customer"."stg_customer_feedback__dbt_tmp" rename to "stg_customer_feedback"
[0m21:51:58.052702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.063560 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m21:51:58.063989 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.064289 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: COMMIT
[0m21:51:58.065302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.070125 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_feedback"
[0m21:51:58.070558 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_feedback"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_feedback__dbt_backup" cascade
[0m21:51:58.071293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.073334 [debug] [Thread-1 (]: On model.customer_360.stg_customer_feedback: Close
[0m21:51:58.074880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef9580>]}
[0m21:51:58.075433 [info ] [Thread-1 (]: 1 of 11 OK created sql view model customer.stg_customer_feedback ............... [[32mOK[0m in 0.09s]
[0m21:51:58.075908 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m21:51:58.076243 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m21:51:58.076657 [info ] [Thread-1 (]: 2 of 11 START sql view model customer.stg_customer_preferences ................. [RUN]
[0m21:51:58.077009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m21:51:58.077304 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m21:51:58.079606 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m21:51:58.080369 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m21:51:58.083410 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customer_preferences"
[0m21:51:58.085231 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.085711 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: BEGIN
[0m21:51:58.086061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.086633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.086929 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.087230 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */

  
  create view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" as (
    

SELECT
    preference_id,
    customer_id,
    preferred_category,
    communication_channel,
    last_updated
FROM customer.raw_customer_preferences
  );

[0m21:51:58.087809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.090653 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.091238 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences" rename to "stg_customer_preferences__dbt_backup"
[0m21:51:58.091924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.095035 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.095412 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
alter view "retail_warehouse"."customer"."stg_customer_preferences__dbt_tmp" rename to "stg_customer_preferences"
[0m21:51:58.096093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.097801 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m21:51:58.098142 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.098500 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: COMMIT
[0m21:51:58.099236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.101334 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customer_preferences"
[0m21:51:58.102303 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customer_preferences"} */
drop view if exists "retail_warehouse"."customer"."stg_customer_preferences__dbt_backup" cascade
[0m21:51:58.103932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.105936 [debug] [Thread-1 (]: On model.customer_360.stg_customer_preferences: Close
[0m21:51:58.107225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2de0>]}
[0m21:51:58.108296 [info ] [Thread-1 (]: 2 of 11 OK created sql view model customer.stg_customer_preferences ............ [[32mOK[0m in 0.03s]
[0m21:51:58.108831 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m21:51:58.109168 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m21:51:58.109574 [info ] [Thread-1 (]: 3 of 11 START sql view model customer.stg_customers ............................ [RUN]
[0m21:51:58.109940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m21:51:58.110229 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m21:51:58.112797 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m21:51:58.113494 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m21:51:58.118249 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.stg_customers"
[0m21:51:58.119093 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.119475 [debug] [Thread-1 (]: On model.customer_360.stg_customers: BEGIN
[0m21:51:58.119791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.120371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.120685 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.121005 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */

  
  create view "retail_warehouse"."customer"."stg_customers__dbt_tmp" as (
    

SELECT
    customer_id,
    first_name,
    last_name,
    email,
    signup_date,
    customer_segment
FROM customer.raw_customers
  );

[0m21:51:58.121626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.124447 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.125081 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:51:58.125672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.128092 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.128397 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
alter view "retail_warehouse"."customer"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:51:58.128841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.130115 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m21:51:58.130402 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.130661 [debug] [Thread-1 (]: On model.customer_360.stg_customers: COMMIT
[0m21:51:58.131215 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.133211 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.stg_customers"
[0m21:51:58.133535 [debug] [Thread-1 (]: On model.customer_360.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.stg_customers"} */
drop view if exists "retail_warehouse"."customer"."stg_customers__dbt_backup" cascade
[0m21:51:58.134086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.135174 [debug] [Thread-1 (]: On model.customer_360.stg_customers: Close
[0m21:51:58.135669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa3bf0>]}
[0m21:51:58.136180 [info ] [Thread-1 (]: 3 of 11 OK created sql view model customer.stg_customers ....................... [[32mOK[0m in 0.03s]
[0m21:51:58.136624 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m21:51:58.136938 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m21:51:58.137361 [info ] [Thread-1 (]: 4 of 11 START sql view model customer.stg_inventory ............................ [RUN]
[0m21:51:58.137844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m21:51:58.138191 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m21:51:58.140488 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m21:51:58.141128 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m21:51:58.143936 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_inventory"
[0m21:51:58.144666 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.144954 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: BEGIN
[0m21:51:58.145230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.145723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.145984 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.146261 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */

  
  create view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" as (
    

SELECT
    inventory_id,
    product_id,
    warehouse_location,
    quantity_on_hand,
    reorder_point,
    last_restock_date
FROM retail.raw_inventory
  );

[0m21:51:58.146837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.149370 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.149678 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m21:51:58.150165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.152618 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.153035 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
alter view "retail_warehouse"."customer"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m21:51:58.153577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.154946 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m21:51:58.155241 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.155512 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: COMMIT
[0m21:51:58.156073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.157968 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_inventory"
[0m21:51:58.158261 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_inventory"} */
drop view if exists "retail_warehouse"."customer"."stg_inventory__dbt_backup" cascade
[0m21:51:58.158767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.159782 [debug] [Thread-1 (]: On model.retail_ops.stg_inventory: Close
[0m21:51:58.160196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e98a10>]}
[0m21:51:58.160684 [info ] [Thread-1 (]: 4 of 11 OK created sql view model customer.stg_inventory ....................... [[32mOK[0m in 0.02s]
[0m21:51:58.161120 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m21:51:58.161424 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m21:51:58.161792 [info ] [Thread-1 (]: 5 of 11 START sql view model customer.stg_products ............................. [RUN]
[0m21:51:58.162118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m21:51:58.162397 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m21:51:58.164579 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m21:51:58.165329 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m21:51:58.168223 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_products"
[0m21:51:58.169211 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.169518 [debug] [Thread-1 (]: On model.retail_ops.stg_products: BEGIN
[0m21:51:58.169785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.170286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.170554 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.170828 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */

  
  create view "retail_warehouse"."customer"."stg_products__dbt_tmp" as (
    

SELECT * FROM retail.raw_products
  );

[0m21:51:58.171508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.174180 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.174485 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products" rename to "stg_products__dbt_backup"
[0m21:51:58.174958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.178647 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.178969 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
alter view "retail_warehouse"."customer"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:51:58.179426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.180709 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m21:51:58.181029 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.181310 [debug] [Thread-1 (]: On model.retail_ops.stg_products: COMMIT
[0m21:51:58.181871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.183803 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_products"
[0m21:51:58.184191 [debug] [Thread-1 (]: On model.retail_ops.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_products"} */
drop view if exists "retail_warehouse"."customer"."stg_products__dbt_backup" cascade
[0m21:51:58.184877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.185980 [debug] [Thread-1 (]: On model.retail_ops.stg_products: Close
[0m21:51:58.186411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109008f80>]}
[0m21:51:58.186894 [info ] [Thread-1 (]: 5 of 11 OK created sql view model customer.stg_products ........................ [[32mOK[0m in 0.02s]
[0m21:51:58.187331 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m21:51:58.187649 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m21:51:58.188091 [info ] [Thread-1 (]: 6 of 11 START sql view model customer.stg_promotions ........................... [RUN]
[0m21:51:58.188520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m21:51:58.188826 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m21:51:58.191100 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m21:51:58.191695 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m21:51:58.194591 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_promotions"
[0m21:51:58.195181 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.195474 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: BEGIN
[0m21:51:58.195753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.196247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.196520 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.196805 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */

  
  create view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" as (
    

SELECT
    promotion_id,
    product_id,
    promotion_name,
    discount_percentage,
    start_date,
    end_date
FROM retail.raw_promotions
  );

[0m21:51:58.197379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.199839 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.200239 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions" rename to "stg_promotions__dbt_backup"
[0m21:51:58.201033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.203945 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.204269 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
alter view "retail_warehouse"."customer"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m21:51:58.204866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.206536 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m21:51:58.206866 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.207147 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: COMMIT
[0m21:51:58.207728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.209552 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_promotions"
[0m21:51:58.210102 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_promotions"} */
drop view if exists "retail_warehouse"."customer"."stg_promotions__dbt_backup" cascade
[0m21:51:58.210795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.211946 [debug] [Thread-1 (]: On model.retail_ops.stg_promotions: Close
[0m21:51:58.212395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e98c50>]}
[0m21:51:58.212900 [info ] [Thread-1 (]: 6 of 11 OK created sql view model customer.stg_promotions ...................... [[32mOK[0m in 0.02s]
[0m21:51:58.213339 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m21:51:58.213654 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m21:51:58.214035 [info ] [Thread-1 (]: 7 of 11 START sql view model customer.stg_sales ................................ [RUN]
[0m21:51:58.214367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m21:51:58.214663 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m21:51:58.216906 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m21:51:58.218365 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m21:51:58.222487 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.stg_sales"
[0m21:51:58.223234 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.223539 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: BEGIN
[0m21:51:58.223823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.224342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.224619 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.224897 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */

  
  create view "retail_warehouse"."customer"."stg_sales__dbt_tmp" as (
    

SELECT
    sale_id,
    product_id,
    customer_id,
    quantity,
    sale_date,
    total_amount
FROM retail.raw_sales
  );

[0m21:51:58.225575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.228647 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.229034 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:51:58.229629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.232562 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.232911 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
alter view "retail_warehouse"."customer"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:51:58.233500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.235199 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m21:51:58.235563 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.235991 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: COMMIT
[0m21:51:58.237218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.240652 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.stg_sales"
[0m21:51:58.241002 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.stg_sales"} */
drop view if exists "retail_warehouse"."customer"."stg_sales__dbt_backup" cascade
[0m21:51:58.241710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.242816 [debug] [Thread-1 (]: On model.retail_ops.stg_sales: Close
[0m21:51:58.243243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b3e90>]}
[0m21:51:58.243725 [info ] [Thread-1 (]: 7 of 11 OK created sql view model customer.stg_sales ........................... [[32mOK[0m in 0.03s]
[0m21:51:58.244161 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m21:51:58.244462 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m21:51:58.244836 [info ] [Thread-1 (]: 8 of 11 START sql table model customer.customer_orders ......................... [RUN]
[0m21:51:58.245205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now model.customer_360.customer_orders)
[0m21:51:58.245480 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m21:51:58.247963 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m21:51:58.248607 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m21:51:58.267717 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_orders"
[0m21:51:58.268822 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.269518 [debug] [Thread-1 (]: On model.customer_360.customer_orders: BEGIN
[0m21:51:58.269914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.270469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.270756 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.271135 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_orders__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        customer_segment
    FROM "retail_warehouse"."customer"."stg_customers"
),

retail_sales AS (
    SELECT
        customer_id,
        sale_id,
        sale_date,
        CAST(total_amount AS DECIMAL(10,2)) as total_amount
    FROM retail.raw_sales
),

customer_orders AS (
    SELECT
        c.customer_id,
        c.first_name,
        c.last_name,
        c.email,
        c.customer_segment,
        COUNT(s.sale_id) AS order_count,
        SUM(s.total_amount) AS total_spend,
        MIN(s.sale_date) AS first_order_date,
        MAX(s.sale_date) AS most_recent_order_date
    FROM customers c
    LEFT JOIN retail_sales s ON c.customer_id = s.customer_id
    GROUP BY 1, 2, 3, 4, 5
)

SELECT * FROM customer_orders
    );
  
  
[0m21:51:58.278023 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:51:58.280892 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.281242 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
alter table "retail_warehouse"."customer"."customer_orders" rename to "customer_orders__dbt_backup"
[0m21:51:58.281904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.284336 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.284654 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
alter table "retail_warehouse"."customer"."customer_orders__dbt_tmp" rename to "customer_orders"
[0m21:51:58.285950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.290933 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m21:51:58.291297 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.291577 [debug] [Thread-1 (]: On model.customer_360.customer_orders: COMMIT
[0m21:51:58.293054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.295203 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_orders"
[0m21:51:58.295526 [debug] [Thread-1 (]: On model.customer_360.customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_orders"} */
drop table if exists "retail_warehouse"."customer"."customer_orders__dbt_backup" cascade
[0m21:51:58.296212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.297316 [debug] [Thread-1 (]: On model.customer_360.customer_orders: Close
[0m21:51:58.297754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f88650>]}
[0m21:51:58.298247 [info ] [Thread-1 (]: 8 of 11 OK created sql table model customer.customer_orders .................... [[32mOK[0m in 0.05s]
[0m21:51:58.298682 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m21:51:58.298995 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m21:51:58.299376 [info ] [Thread-1 (]: 9 of 11 START sql table model customer.customer_profile_360 .................... [RUN]
[0m21:51:58.299704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.customer_360.customer_profile_360)
[0m21:51:58.299985 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m21:51:58.303541 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m21:51:58.304407 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m21:51:58.307611 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer_360.customer_profile_360"
[0m21:51:58.308426 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.308764 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: BEGIN
[0m21:51:58.309056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.309595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.309879 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.310209 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."customer_profile_360__dbt_tmp"
  
    as (
      

WITH customer_base AS (
    SELECT
        c.*,
        cp.preferred_category,
        cp.communication_channel
    FROM "retail_warehouse"."customer"."stg_customers" c
    LEFT JOIN "retail_warehouse"."customer"."stg_customer_preferences" cp ON c.customer_id = cp.customer_id
),

customer_feedback_agg AS (
    SELECT
        customer_id,
        AVG(rating) as avg_rating,
        COUNT(*) as total_feedback_count
    FROM "retail_warehouse"."customer"."stg_customer_feedback"
    GROUP BY customer_id
),

final_profile AS (
    SELECT
        cb.*,
        COALESCE(cf.avg_rating, 0) as average_rating,
        COALESCE(cf.total_feedback_count, 0) as feedback_count
    FROM customer_base cb
    LEFT JOIN customer_feedback_agg cf ON cb.customer_id = cf.customer_id
)

SELECT * FROM final_profile
    );
  
  
[0m21:51:58.315380 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:58.318081 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.318664 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360" rename to "customer_profile_360__dbt_backup"
[0m21:51:58.319331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.322018 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.322410 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
alter table "retail_warehouse"."customer"."customer_profile_360__dbt_tmp" rename to "customer_profile_360"
[0m21:51:58.322995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.324768 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m21:51:58.325140 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.325432 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: COMMIT
[0m21:51:58.326175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.328319 [debug] [Thread-1 (]: Using duckdb connection "model.customer_360.customer_profile_360"
[0m21:51:58.328648 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.customer_360.customer_profile_360"} */
drop table if exists "retail_warehouse"."customer"."customer_profile_360__dbt_backup" cascade
[0m21:51:58.329324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.330398 [debug] [Thread-1 (]: On model.customer_360.customer_profile_360: Close
[0m21:51:58.331054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3a40>]}
[0m21:51:58.332402 [info ] [Thread-1 (]: 9 of 11 OK created sql table model customer.customer_profile_360 ............... [[32mOK[0m in 0.03s]
[0m21:51:58.333106 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m21:51:58.333443 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m21:51:58.333857 [info ] [Thread-1 (]: 10 of 11 START sql table model customer.inventory_status ....................... [RUN]
[0m21:51:58.334233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now model.retail_ops.inventory_status)
[0m21:51:58.334536 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m21:51:58.337595 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m21:51:58.338358 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m21:51:58.342552 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.inventory_status"
[0m21:51:58.343148 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.343454 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: BEGIN
[0m21:51:58.343734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.344243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.344518 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.344833 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."inventory_status__dbt_tmp"
  
    as (
      

WITH inventory_metrics AS (
    SELECT 
        i.inventory_id,
        i.warehouse_location,
        p.product_id,
        p.product_name,
        p.category,
        i.quantity_on_hand,
        i.reorder_point,
        i.last_restock_date,
        CASE 
            WHEN i.quantity_on_hand <= i.reorder_point THEN 'Reorder Required'
            WHEN i.quantity_on_hand <= (i.reorder_point * 1.5) THEN 'Low Stock'
            ELSE 'Sufficient Stock'
        END as stock_status
    FROM "retail_warehouse"."customer"."stg_inventory" i
    JOIN "retail_warehouse"."customer"."stg_products" p ON i.product_id = p.product_id
)

SELECT * FROM inventory_metrics
    );
  
  
[0m21:51:58.347571 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:51:58.388435 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.388865 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status" rename to "inventory_status__dbt_backup"
[0m21:51:58.389477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.391978 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.392319 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
alter table "retail_warehouse"."customer"."inventory_status__dbt_tmp" rename to "inventory_status"
[0m21:51:58.392831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.394392 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m21:51:58.394696 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.394971 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: COMMIT
[0m21:51:58.395649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.397727 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.inventory_status"
[0m21:51:58.398051 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.inventory_status"} */
drop table if exists "retail_warehouse"."customer"."inventory_status__dbt_backup" cascade
[0m21:51:58.398734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.399866 [debug] [Thread-1 (]: On model.retail_ops.inventory_status: Close
[0m21:51:58.400308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109042390>]}
[0m21:51:58.400794 [info ] [Thread-1 (]: 10 of 11 OK created sql table model customer.inventory_status .................. [[32mOK[0m in 0.07s]
[0m21:51:58.401230 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m21:51:58.401740 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m21:51:58.402147 [info ] [Thread-1 (]: 11 of 11 START sql table model customer.product_sales .......................... [RUN]
[0m21:51:58.402486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.retail_ops.product_sales)
[0m21:51:58.402775 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m21:51:58.405489 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m21:51:58.406095 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m21:51:58.409015 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_ops.product_sales"
[0m21:51:58.409623 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.409929 [debug] [Thread-1 (]: On model.retail_ops.product_sales: BEGIN
[0m21:51:58.410205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:58.410702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.410977 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.411270 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */

  
    
    

    create  table
      "retail_warehouse"."customer"."product_sales__dbt_tmp"
  
    as (
      

WITH product_sales AS (
    SELECT 
        s.sale_id,
        s.customer_id,
        p.product_id,
        p.product_name,
        p.category,
        s.quantity,
        s.sale_date,
        s.total_amount
    FROM "retail_warehouse"."customer"."stg_sales" s
    JOIN "retail_warehouse"."customer"."stg_products" p ON s.product_id = p.product_id
)

SELECT * FROM product_sales
    );
  
  
[0m21:51:58.412972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:58.415463 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.415788 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales" rename to "product_sales__dbt_backup"
[0m21:51:58.416272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.418677 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.419036 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
alter table "retail_warehouse"."customer"."product_sales__dbt_tmp" rename to "product_sales"
[0m21:51:58.419612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.421082 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m21:51:58.421382 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.421651 [debug] [Thread-1 (]: On model.retail_ops.product_sales: COMMIT
[0m21:51:58.422346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.424374 [debug] [Thread-1 (]: Using duckdb connection "model.retail_ops.product_sales"
[0m21:51:58.424693 [debug] [Thread-1 (]: On model.retail_ops.product_sales: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "node_id": "model.retail_ops.product_sales"} */
drop table if exists "retail_warehouse"."customer"."product_sales__dbt_backup" cascade
[0m21:51:58.425296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:58.426346 [debug] [Thread-1 (]: On model.retail_ops.product_sales: Close
[0m21:51:58.426762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ff8c83-cedc-405b-9809-c515c8ba850e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041100>]}
[0m21:51:58.427238 [info ] [Thread-1 (]: 11 of 11 OK created sql table model customer.product_sales ..................... [[32mOK[0m in 0.02s]
[0m21:51:58.427664 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m21:51:58.428508 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:58.428759 [debug] [MainThread]: On master: BEGIN
[0m21:51:58.429003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:58.429362 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:58.429593 [debug] [MainThread]: On master: COMMIT
[0m21:51:58.429819 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:58.430036 [debug] [MainThread]: On master: COMMIT
[0m21:51:58.430408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:58.430690 [debug] [MainThread]: On master: Close
[0m21:51:58.431006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:58.431234 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m21:51:58.431539 [info ] [MainThread]: 
[0m21:51:58.431825 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m21:51:58.433292 [debug] [MainThread]: Command end result
[0m21:51:58.455827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:51:58.457369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:51:58.462486 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m21:51:58.462777 [info ] [MainThread]: 
[0m21:51:58.463093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:58.463343 [info ] [MainThread]: 
[0m21:51:58.463603 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m21:51:58.465074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2258537, "process_in_blocks": "0", "process_kernel_time": 0.264262, "process_mem_max_rss": "153092096", "process_out_blocks": "0", "process_user_time": 2.173112}
[0m21:51:58.465471 [debug] [MainThread]: Command `dbt run` succeeded at 21:51:58.465395 after 1.23 seconds
[0m21:51:58.465790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a785f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb82f0>]}
[0m21:51:58.466111 [debug] [MainThread]: Flushing usage events
[0m21:51:59.880491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:01.496172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d61910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9fef0>]}


============================== 21:52:01.500890 | b2befaba-8f58-4286-9a0a-b17d6778ebc3 ==============================
[0m21:52:01.500890 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:52:01.501406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/telvin/Desktop/dbt/dbt_projects/customer_360/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:52:01.693801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdca10>]}
[0m21:52:01.742011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106767a40>]}
[0m21:52:01.745707 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m21:52:01.823890 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:52:01.924667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:01.925035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:01.964528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048daf60>]}
[0m21:52:01.979147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107121eb0>]}
[0m21:52:01.979606 [info ] [MainThread]: Found 11 models, 6 data tests, 16 sources, 426 macros
[0m21:52:01.979916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f475f0>]}
[0m21:52:01.981947 [info ] [MainThread]: 
[0m21:52:01.982278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:01.982543 [info ] [MainThread]: 
[0m21:52:01.982941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:52:01.987488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_retail_warehouse_customer'
[0m21:52:02.028135 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:52:02.028534 [debug] [ThreadPool]: On list_retail_warehouse_customer: BEGIN
[0m21:52:02.028796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:02.041953 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:52:02.042355 [debug] [ThreadPool]: Using duckdb connection "list_retail_warehouse_customer"
[0m21:52:02.042646 [debug] [ThreadPool]: On list_retail_warehouse_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "list_retail_warehouse_customer"} */
select
      'retail_warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'customer'
    and lower(table_catalog) = 'retail_warehouse'
  
[0m21:52:02.059355 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:52:02.060833 [debug] [ThreadPool]: On list_retail_warehouse_customer: ROLLBACK
[0m21:52:02.061983 [debug] [ThreadPool]: Failed to rollback 'list_retail_warehouse_customer'
[0m21:52:02.062261 [debug] [ThreadPool]: On list_retail_warehouse_customer: Close
[0m21:52:02.064110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2befaba-8f58-4286-9a0a-b17d6778ebc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce33b0>]}
[0m21:52:02.066010 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_feedback
[0m21:52:02.066350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_warehouse_customer, now model.customer_360.stg_customer_feedback)
[0m21:52:02.066645 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_feedback
[0m21:52:02.073311 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_feedback"
[0m21:52:02.074017 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_feedback
[0m21:52:02.074589 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_feedback
[0m21:52:02.074906 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customer_preferences
[0m21:52:02.075266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_feedback, now model.customer_360.stg_customer_preferences)
[0m21:52:02.075587 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customer_preferences
[0m21:52:02.077710 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customer_preferences"
[0m21:52:02.078234 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customer_preferences
[0m21:52:02.078743 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customer_preferences
[0m21:52:02.079039 [debug] [Thread-1 (]: Began running node model.customer_360.stg_customers
[0m21:52:02.079361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customer_preferences, now model.customer_360.stg_customers)
[0m21:52:02.079658 [debug] [Thread-1 (]: Began compiling node model.customer_360.stg_customers
[0m21:52:02.081655 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.stg_customers"
[0m21:52:02.082147 [debug] [Thread-1 (]: Began executing node model.customer_360.stg_customers
[0m21:52:02.082646 [debug] [Thread-1 (]: Finished running node model.customer_360.stg_customers
[0m21:52:02.082952 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_inventory
[0m21:52:02.083280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.stg_customers, now model.retail_ops.stg_inventory)
[0m21:52:02.083598 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_inventory
[0m21:52:02.087154 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_inventory"
[0m21:52:02.087890 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_inventory
[0m21:52:02.088493 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_inventory
[0m21:52:02.088821 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_products
[0m21:52:02.089167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_inventory, now model.retail_ops.stg_products)
[0m21:52:02.089454 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_products
[0m21:52:02.091532 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_products"
[0m21:52:02.092079 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_products
[0m21:52:02.092578 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_products
[0m21:52:02.092877 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_promotions
[0m21:52:02.093188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_products, now model.retail_ops.stg_promotions)
[0m21:52:02.093495 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_promotions
[0m21:52:02.095565 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_promotions"
[0m21:52:02.096026 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_promotions
[0m21:52:02.096502 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_promotions
[0m21:52:02.096789 [debug] [Thread-1 (]: Began running node model.retail_ops.stg_sales
[0m21:52:02.097080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_promotions, now model.retail_ops.stg_sales)
[0m21:52:02.097349 [debug] [Thread-1 (]: Began compiling node model.retail_ops.stg_sales
[0m21:52:02.099305 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.stg_sales"
[0m21:52:02.099753 [debug] [Thread-1 (]: Began executing node model.retail_ops.stg_sales
[0m21:52:02.100227 [debug] [Thread-1 (]: Finished running node model.retail_ops.stg_sales
[0m21:52:02.100525 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m21:52:02.100829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.stg_sales, now test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d)
[0m21:52:02.101125 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m21:52:02.111291 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d"
[0m21:52:02.112074 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m21:52:02.112628 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d
[0m21:52:02.112943 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m21:52:02.113280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_feedback_feedback_id.dce861dc2d, now test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19)
[0m21:52:02.113571 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m21:52:02.118825 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19"
[0m21:52:02.119502 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m21:52:02.120022 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19
[0m21:52:02.120330 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m21:52:02.120680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_feedback_feedback_id.c0b0077f19, now test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc)
[0m21:52:02.121023 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m21:52:02.124669 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc"
[0m21:52:02.125361 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m21:52:02.125882 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc
[0m21:52:02.126192 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m21:52:02.126532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customer_preferences_preference_id.cdffaa2fcc, now test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718)
[0m21:52:02.126852 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m21:52:02.130073 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718"
[0m21:52:02.130616 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m21:52:02.131112 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718
[0m21:52:02.131417 [debug] [Thread-1 (]: Began running node model.customer_360.customer_orders
[0m21:52:02.131731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customer_preferences_preference_id.cba7b84718, now model.customer_360.customer_orders)
[0m21:52:02.132016 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_orders
[0m21:52:02.134348 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_orders"
[0m21:52:02.134828 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_orders
[0m21:52:02.135330 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_orders
[0m21:52:02.135634 [debug] [Thread-1 (]: Began running node model.customer_360.customer_profile_360
[0m21:52:02.135943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_orders, now model.customer_360.customer_profile_360)
[0m21:52:02.136208 [debug] [Thread-1 (]: Began compiling node model.customer_360.customer_profile_360
[0m21:52:02.138959 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer_360.customer_profile_360"
[0m21:52:02.139499 [debug] [Thread-1 (]: Began executing node model.customer_360.customer_profile_360
[0m21:52:02.139992 [debug] [Thread-1 (]: Finished running node model.customer_360.customer_profile_360
[0m21:52:02.140304 [debug] [Thread-1 (]: Began running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:52:02.140601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer_360.customer_profile_360, now test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:52:02.140867 [debug] [Thread-1 (]: Began compiling node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:52:02.143990 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:52:02.144501 [debug] [Thread-1 (]: Began executing node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:52:02.144996 [debug] [Thread-1 (]: Finished running node test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:52:02.145309 [debug] [Thread-1 (]: Began running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m21:52:02.145618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.customer_360.unique_stg_customers_customer_id.c7614daada)
[0m21:52:02.145903 [debug] [Thread-1 (]: Began compiling node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m21:52:02.148997 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer_360.unique_stg_customers_customer_id.c7614daada"
[0m21:52:02.149518 [debug] [Thread-1 (]: Began executing node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m21:52:02.150005 [debug] [Thread-1 (]: Finished running node test.customer_360.unique_stg_customers_customer_id.c7614daada
[0m21:52:02.150319 [debug] [Thread-1 (]: Began running node model.retail_ops.inventory_status
[0m21:52:02.150616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer_360.unique_stg_customers_customer_id.c7614daada, now model.retail_ops.inventory_status)
[0m21:52:02.150886 [debug] [Thread-1 (]: Began compiling node model.retail_ops.inventory_status
[0m21:52:02.154907 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.inventory_status"
[0m21:52:02.155411 [debug] [Thread-1 (]: Began executing node model.retail_ops.inventory_status
[0m21:52:02.155903 [debug] [Thread-1 (]: Finished running node model.retail_ops.inventory_status
[0m21:52:02.156207 [debug] [Thread-1 (]: Began running node model.retail_ops.product_sales
[0m21:52:02.156501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_ops.inventory_status, now model.retail_ops.product_sales)
[0m21:52:02.156766 [debug] [Thread-1 (]: Began compiling node model.retail_ops.product_sales
[0m21:52:02.159068 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_ops.product_sales"
[0m21:52:02.159518 [debug] [Thread-1 (]: Began executing node model.retail_ops.product_sales
[0m21:52:02.159983 [debug] [Thread-1 (]: Finished running node model.retail_ops.product_sales
[0m21:52:02.160673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:02.160968 [debug] [MainThread]: Connection 'model.retail_ops.product_sales' was properly closed.
[0m21:52:02.162911 [debug] [MainThread]: Command end result
[0m21:52:02.232570 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:52:02.234102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:52:02.240116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/run_results.json
[0m21:52:02.248169 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m21:52:02.248450 [info ] [MainThread]: Building catalog
[0m21:52:02.259280 [debug] [ThreadPool]: Acquiring new duckdb connection 'retail_warehouse.information_schema'
[0m21:52:02.265427 [debug] [ThreadPool]: Using duckdb connection "retail_warehouse.information_schema"
[0m21:52:02.265719 [debug] [ThreadPool]: On retail_warehouse.information_schema: BEGIN
[0m21:52:02.265950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:02.266414 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:52:02.266647 [debug] [ThreadPool]: Using duckdb connection "retail_warehouse.information_schema"
[0m21:52:02.266936 [debug] [ThreadPool]: On retail_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "customer_360", "target_name": "dev", "connection_name": "retail_warehouse.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'retail_warehouse'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'retail_warehouse'
    )
    select
        'retail_warehouse' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('customer') or upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m21:52:02.275306 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:52:02.298215 [debug] [ThreadPool]: On retail_warehouse.information_schema: ROLLBACK
[0m21:52:02.299212 [debug] [ThreadPool]: Failed to rollback 'retail_warehouse.information_schema'
[0m21:52:02.299480 [debug] [ThreadPool]: On retail_warehouse.information_schema: Close
[0m21:52:02.326984 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/catalog.json
[0m21:52:02.346761 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/manifest.json
[0m21:52:02.348042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/semantic_manifest.json
[0m21:52:02.348322 [info ] [MainThread]: Catalog written to /Users/telvin/Desktop/dbt/dbt_projects/customer_360/target/catalog.json
[0m21:52:02.349642 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.90971565, "process_in_blocks": "0", "process_kernel_time": 0.228675, "process_mem_max_rss": "144162816", "process_out_blocks": "0", "process_user_time": 1.936185}
[0m21:52:02.350020 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:52:02.349945 after 0.91 seconds
[0m21:52:02.350280 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:52:02.350502 [debug] [MainThread]: Connection 'retail_warehouse.information_schema' was properly closed.
[0m21:52:02.350906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9fb60>]}
[0m21:52:02.351250 [debug] [MainThread]: Flushing usage events
[0m21:52:03.622335 [debug] [MainThread]: An error was encountered while trying to flush usage events
